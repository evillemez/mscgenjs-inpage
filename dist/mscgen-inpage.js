/**
 * @license almond 0.3.1 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/*
 This file is part of mscgen_js.

 mscgen_js is free software: you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.

 mscgen_js is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.

 You should have received a copy of the GNU General Public License
 along with mscgen_js.  If not, see <http://www.gnu.org/licenses/>.
 */

/**
 * @license
 * lodash 4.6.1 (Custom Build) <https://lodash.com/>
 * Build: `lodash exports="umd" include="memoize,cloneDeep,flatten,defaults" --development --output lib/lodash/lodash.custom.js`
 * Copyright 2012-2016 The Dojo Foundation <http://dojofoundation.org/>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright 2009-2016 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 * Available under MIT license <https://lodash.com/license>
 */

(function(){var e,t,n;(function(r){function v(e,t){return h.call(e,t)}function m(e,t){var n,r,i,s,o,u,a,f,c,h,p,v=t&&t.split("/"),m=l.map,g=m&&m["*"]||{};if(e&&e.charAt(0)===".")if(t){e=e.split("/"),o=e.length-1,l.nodeIdCompat&&d.test(e[o])&&(e[o]=e[o].replace(d,"")),e=v.slice(0,v.length-1).concat(e);for(c=0;c<e.length;c+=1){p=e[c];if(p===".")e.splice(c,1),c-=1;else if(p===".."){if(c===1&&(e[2]===".."||e[0]===".."))break;c>0&&(e.splice(c-1,2),c-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((v||g)&&m){n=e.split("/");for(c=n.length;c>0;c-=1){r=n.slice(0,c).join("/");if(v)for(h=v.length;h>0;h-=1){i=m[v.slice(0,h).join("/")];if(i){i=i[r];if(i){s=i,u=c;break}}}if(s)break;!a&&g&&g[r]&&(a=g[r],f=c)}!s&&a&&(s=a,u=f),s&&(n.splice(0,u,s),e=n.join("/"))}return e}function g(e,t){return function(){var n=p.call(arguments,0);return typeof n[0]!="string"&&n.length===1&&n.push(null),s.apply(r,n.concat([e,t]))}}function y(e){return function(t){return m(t,e)}}function b(e){return function(t){a[e]=t}}function w(e){if(v(f,e)){var t=f[e];delete f[e],c[e]=!0,i.apply(r,t)}if(!v(a,e)&&!v(c,e))throw new Error("No "+e);return a[e]}function E(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function S(e){return function(){return l&&l.config&&l.config[e]||{}}}var i,s,o,u,a={},f={},l={},c={},h=Object.prototype.hasOwnProperty,p=[].slice,d=/\.js$/;o=function(e,t){var n,r=E(e),i=r[0];return e=r[1],i&&(i=m(i,t),n=w(i)),i?n&&n.normalize?e=n.normalize(e,y(t)):e=m(e,t):(e=m(e,t),r=E(e),i=r[0],e=r[1],i&&(n=w(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},u={require:function(e){return g(e)},exports:function(e){var t=a[e];return typeof t!="undefined"?t:a[e]={}},module:function(e){return{id:e,uri:"",exports:a[e],config:S(e)}}},i=function(e,t,n,i){var s,l,h,p,d,m=[],y=typeof n,E;i=i||e;if(y==="undefined"||y==="function"){t=!t.length&&n.length?["require","exports","module"]:t;for(d=0;d<t.length;d+=1){p=o(t[d],i),l=p.f;if(l==="require")m[d]=u.require(e);else if(l==="exports")m[d]=u.exports(e),E=!0;else if(l==="module")s=m[d]=u.module(e);else if(v(a,l)||v(f,l)||v(c,l))m[d]=w(l);else{if(!p.p)throw new Error(e+" missing "+l);p.p.load(p.n,g(i,!0),b(l),{}),m[d]=a[l]}}h=n?n.apply(a[e],m):undefined;if(e)if(s&&s.exports!==r&&s.exports!==a[e])a[e]=s.exports;else if(h!==r||!E)a[e]=h}else e&&(a[e]=n)},e=t=s=function(e,t,n,a,f){if(typeof e=="string")return u[e]?u[e](t):w(o(e,t).f);if(!e.splice){l=e,l.deps&&s(l.deps,l.callback);if(!t)return;t.splice?(e=t,t=n,n=null):e=r}return t=t||function(){},typeof n=="function"&&(n=a,a=f),a?i(r,e,t,n):setTimeout(function(){i(r,e,t,n)},4),s},s.config=function(e){return s(e)},e._defined=a,n=function(e,t,n){if(typeof e!="string")throw new Error("See almond README: incorrect module build, no module name");t.splice||(n=t,t=[]),!v(a,e)&&!v(f,e)&&(f[e]=[e,t,n])},n.amd={jQuery:!0}})(),n("../node_modules/almond/almond",function(){}),n("lib/mscgenjs-core/parse/xuparser",[],function(){"use strict";function e(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}function t(e,n,r,i){this.message=e,this.expected=n,this.found=r,this.location=i,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,t)}function n(e){function $i(){return e.substring(Ri,qi)}function Ji(){return Yi(Ri,qi)}function Ki(t){throw es(null,[{type:"other",description:t}],e.substring(Ri,qi),Yi(Ri,qi))}function Qi(t){throw es(t,null,e.substring(Ri,qi),Yi(Ri,qi))}function Gi(t){var n=Ui[t],r,i;if(n)return n;r=t-1;while(!Ui[r])r--;n=Ui[r],n={line:n.line,column:n.column,seenCR:n.seenCR};while(r<t)i=e.charAt(r),i==="\n"?(n.seenCR||n.line++,n.column=1,n.seenCR=!1):i==="\r"||i==="\u2028"||i==="\u2029"?(n.line++,n.column=1,n.seenCR=!0):(n.column++,n.seenCR=!1),r++;return Ui[t]=n,n}function Yi(e,t){var n=Gi(e),r=Gi(t);return{start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:r.line,column:r.column}}}function Zi(e){if(qi<zi)return;qi>zi&&(zi=qi,Wi=[]),Wi.push(e)}function es(e,n,r,i){function s(e){var t=1;e.sort(function(e,t){return e.description<t.description?-1:e.description>t.description?1:0});while(t<e.length)e[t-1]===e[t]?e.splice(t,1):t++}function o(e,t){function n(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+t(e)}).replace(/[\u0100-\u0FFF]/g,function(e){return"\\u0"+t(e)}).replace(/[\u1000-\uFFFF]/g,function(e){return"\\u"+t(e)})}var r=new Array(e.length),i,s,o;for(o=0;o<e.length;o++)r[o]=e[o].description;return i=e.length>1?r.slice(0,-1).join(", ")+" or "+r[e.length-1]:r[0],s=t?'"'+n(t)+'"':"end of input","Expected "+i+" but "+s+" found."}return n!==null&&s(n),new t(e!==null?e:o(n,r),n,r,i)}function ts(){var t,n,r,s,o,h,p,d,v,m;return t=qi,n=Rs(),n!==i?(r=ns(),r!==i?(s=Rs(),s!==i?(e.charCodeAt(qi)===123?(o=u,qi++):(o=i,Xi===0&&Zi(a)),o!==i?(h=Rs(),h!==i?(p=rs(),p!==i?(d=Rs(),d!==i?(e.charCodeAt(qi)===125?(v=f,qi++):(v=i,Xi===0&&Zi(l)),v!==i?(m=Rs(),m!==i?(Ri=t,n=c(n,p),t=n):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i),t}function ns(){var t;return e.substr(qi,3).toLowerCase()===h?(t=e.substr(qi,3),qi+=3):(t=i,Xi===0&&Zi(p)),t===i&&(e.substr(qi,2).toLowerCase()===d?(t=e.substr(qi,2),qi+=2):(t=i,Xi===0&&Zi(v))),t}function rs(){var e,t,n,r,s;return e=qi,t=qi,n=is(),n!==i&&(Ri=t,n=m(n)),t=n,t===i&&(t=null),t!==i?(n=qi,r=os(),r!==i&&(Ri=n,r=g(r)),n=r,n===i&&(n=null),n!==i?(r=qi,s=as(),s!==i&&(Ri=r,s=y(s)),r=s,r===i&&(r=null),r!==i?(t=[t,n,r],e=t):(qi=e,e=i)):(qi=e,e=i)):(qi=e,e=i),e}function is(){var t,n,r,s,o,u;t=qi,n=qi,r=[],s=qi,o=ss(),o!==i?(e.charCodeAt(qi)===44?(u=b,qi++):(u=i,Xi===0&&Zi(w)),u!==i?(Ri=s,o=E(o),s=o):(qi=s,s=i)):(qi=s,s=i);while(s!==i)r.push(s),s=qi,o=ss(),o!==i?(e.charCodeAt(qi)===44?(u=b,qi++):(u=i,Xi===0&&Zi(w)),u!==i?(Ri=s,o=E(o),s=o):(qi=s,s=i)):(qi=s,s=i);return r!==i?(s=qi,o=ss(),o!==i?(e.charCodeAt(qi)===59?(u=S,qi++):(u=i,Xi===0&&Zi(x)),u!==i?(Ri=s,o=E(o),s=o):(qi=s,s=i)):(qi=s,s=i),s!==i?(r=[r,s],n=r):(qi=n,n=i)):(qi=n,n=i),n!==i&&(Ri=t,n=T(n)),t=n,t}function ss(){var t,n,r,s,o,u,a,f;return Xi++,t=qi,n=Rs(),n!==i?(e.substr(qi,6).toLowerCase()===C?(r=e.substr(qi,6),qi+=6):(r=i,Xi===0&&Zi(k)),r===i&&(e.substr(qi,11).toLowerCase()===L?(r=e.substr(qi,11),qi+=11):(r=i,Xi===0&&Zi(A))),r!==i?(s=Rs(),s!==i?(e.charCodeAt(qi)===61?(o=O,qi++):(o=i,Xi===0&&Zi(M)),o!==i?(u=Rs(),u!==i?(a=Us(),a!==i?(f=Rs(),f!==i?(Ri=t,n=_(r,a),t=n):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i),t===i&&(t=qi,n=Rs(),n!==i?(e.substr(qi,5).toLowerCase()===D?(r=e.substr(qi,5),qi+=5):(r=i,Xi===0&&Zi(P)),r!==i?(s=Rs(),s!==i?(e.charCodeAt(qi)===61?(o=O,qi++):(o=i,Xi===0&&Zi(M)),o!==i?(u=Rs(),u!==i?(a=Qs(),a!==i?(f=Rs(),f!==i?(Ri=t,n=_(r,a),t=n):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i),t===i&&(t=qi,n=Rs(),n!==i?(e.substr(qi,12).toLowerCase()===H?(r=e.substr(qi,12),qi+=12):(r=i,Xi===0&&Zi(B)),r!==i?(s=Rs(),s!==i?(e.charCodeAt(qi)===61?(o=O,qi++):(o=i,Xi===0&&Zi(M)),o!==i?(u=Rs(),u!==i?(a=$s(),a!==i?(f=Rs(),f!==i?(Ri=t,n=j(r,a),t=n):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i),t===i&&(t=qi,n=Rs(),n!==i?(e.substr(qi,9).toLowerCase()===F?(r=e.substr(qi,9),qi+=9):(r=i,Xi===0&&Zi(I)),r!==i?(s=Rs(),s!==i?(e.charCodeAt(qi)===61?(o=O,qi++):(o=i,Xi===0&&Zi(M)),o!==i?(u=Rs(),u!==i?(a=ks(),a!==i?(f=Rs(),f!==i?(Ri=t,n=_(r,a),t=n):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)))),Xi--,t===i&&(n=i,Xi===0&&Zi(N)),t}function os(){var t,n,r,s,o,u;t=qi,n=qi,r=[],s=qi,o=us(),o!==i?(e.charCodeAt(qi)===44?(u=b,qi++):(u=i,Xi===0&&Zi(w)),u!==i?(Ri=s,o=q(o),s=o):(qi=s,s=i)):(qi=s,s=i);while(s!==i)r.push(s),s=qi,o=us(),o!==i?(e.charCodeAt(qi)===44?(u=b,qi++):(u=i,Xi===0&&Zi(w)),u!==i?(Ri=s,o=q(o),s=o):(qi=s,s=i)):(qi=s,s=i);return r!==i?(s=qi,o=us(),o!==i?(e.charCodeAt(qi)===59?(u=S,qi++):(u=i,Xi===0&&Zi(x)),u!==i?(Ri=s,o=q(o),s=o):(qi=s,s=i)):(qi=s,s=i),s!==i?(r=[r,s],n=r):(qi=n,n=i)):(qi=n,n=i),n!==i&&(Ri=t,n=R(n)),t=n,t}function us(){var t,n,r,s,o,u,a,f;return Xi++,t=qi,n=Rs(),n!==i?(r=ks(),r!==i?(s=Rs(),s!==i?(o=qi,e.charCodeAt(qi)===91?(u=z,qi++):(u=i,Xi===0&&Zi(W)),u!==i?(a=Ts(),a!==i?(e.charCodeAt(qi)===93?(f=X,qi++):(f=i,Xi===0&&Zi(V)),f!==i?(Ri=o,u=$(r,a),o=u):(qi=o,o=i)):(qi=o,o=i)):(qi=o,o=i),o===i&&(o=null),o!==i?(u=Rs(),u!==i?(Ri=t,n=J(r,o),t=n):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i),t===i&&(t=qi,n=Rs(),n!==i?(r=Os(),r!==i?(s=Rs(),s!==i?(o=qi,e.charCodeAt(qi)===91?(u=z,qi++):(u=i,Xi===0&&Zi(W)),u!==i?(a=Ts(),a!==i?(e.charCodeAt(qi)===93?(f=X,qi++):(f=i,Xi===0&&Zi(V)),f!==i?(Ri=o,u=$(r,a),o=u):(qi=o,o=i)):(qi=o,o=i)):(qi=o,o=i),o===i&&(o=null),o!==i?(u=Rs(),u!==i?(Ri=t,n=K(r,o),t=n):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)),Xi--,t===i&&(n=i,Xi===0&&Zi(U)),t}function as(){var t,n,r,s,o;t=[],n=qi,r=fs(),r!==i?(s=Rs(),s!==i?(e.charCodeAt(qi)===59?(o=S,qi++):(o=i,Xi===0&&Zi(x)),o!==i?(Ri=n,r=Q(r),n=r):(qi=n,n=i)):(qi=n,n=i)):(qi=n,n=i);if(n!==i)while(n!==i)t.push(n),n=qi,r=fs(),r!==i?(s=Rs(),s!==i?(e.charCodeAt(qi)===59?(o=S,qi++):(o=i,Xi===0&&Zi(x)),o!==i?(Ri=n,r=Q(r),n=r):(qi=n,n=i)):(qi=n,n=i)):(qi=n,n=i);else t=i;return t}function fs(){var t,n,r,s,o,u,a;t=qi,n=qi,r=[],s=qi,o=ls(),o!==i?(u=Rs(),u!==i?(e.charCodeAt(qi)===44?(a=b,qi++):(a=i,Xi===0&&Zi(w)),a!==i?(Ri=s,o=Q(o),s=o):(qi=s,s=i)):(qi=s,s=i)):(qi=s,s=i);while(s!==i)r.push(s),s=qi,o=ls(),o!==i?(u=Rs(),u!==i?(e.charCodeAt(qi)===44?(a=b,qi++):(a=i,Xi===0&&Zi(w)),a!==i?(Ri=s,o=Q(o),s=o):(qi=s,s=i)):(qi=s,s=i)):(qi=s,s=i);return r!==i?(s=qi,o=ls(),o!==i&&(Ri=s,o=G(o)),s=o,s!==i?(r=[r,s],n=r):(qi=n,n=i)):(qi=n,n=i),n!==i&&(Ri=t,n=Y(n)),t=n,t}function ls(){var e;return e=cs(),e===i&&(e=vs()),e}function cs(){var t,n,r,s,o,u;return t=qi,n=qi,r=hs(),r!==i&&(Ri=n,r=Q(r)),n=r,n===i&&(n=qi,r=ds(),r!==i&&(Ri=n,r=Q(r)),n=r,n===i&&(n=qi,r=ps(),r!==i&&(Ri=n,r=Q(r)),n=r)),n!==i?(r=qi,e.charCodeAt(qi)===91?(s=z,qi++):(s=i,Xi===0&&Zi(W)),s!==i?(o=Ts(),o!==i?(e.charCodeAt(qi)===93?(u=X,qi++):(u=i,Xi===0&&Zi(V)),u!==i?(Ri=r,s=Z(n,o),r=s):(qi=r,r=i)):(qi=r,r=i)):(qi=r,r=i),r===i&&(r=null),r!==i?(Ri=t,n=et(n,r),t=n):(qi=t,t=i)):(qi=t,t=i),t}function hs(){var e,t,n,r;return e=qi,t=Rs(),t!==i?(n=ms(),n!==i?(r=Rs(),r!==i?(Ri=e,t=tt(n),e=t):(qi=e,e=i)):(qi=e,e=i)):(qi=e,e=i),e}function ps(){var e,t,n,r;return e=qi,t=Rs(),t!==i?(n=gs(),n!==i?(r=Rs(),r!==i?(Ri=e,t=tt(n),e=t):(qi=e,e=i)):(qi=e,e=i)):(qi=e,e=i),e}function ds(){var t,n,r,s,o,u,a,f;return t=qi,n=Rs(),n!==i?(r=As(),r!==i?(s=Rs(),s!==i?(o=ys(),o!==i?(u=Rs(),u!==i?(a=As(),a!==i?(f=Rs(),f!==i?(Ri=t,n=nt(r,o,a),t=n):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i),t===i&&(t=qi,n=Rs(),n!==i?(e.charCodeAt(qi)===42?(r=rt,qi++):(r=i,Xi===0&&Zi(it)),r!==i?(s=Rs(),s!==i?(o=Es(),o!==i?(u=Rs(),u!==i?(a=As(),a!==i?(f=Rs(),f!==i?(Ri=t,n=st(o,a),t=n):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i),t===i&&(t=qi,n=Rs(),n!==i?(r=As(),r!==i?(s=Rs(),s!==i?(o=ws(),o!==i?(u=Rs(),u!==i?(e.charCodeAt(qi)===42?(a=rt,qi++):(a=i,Xi===0&&Zi(it)),a!==i?(f=Rs(),f!==i?(Ri=t,n=ot(r,o),t=n):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i),t===i&&(t=qi,n=Rs(),n!==i?(r=As(),r!==i?(s=Rs(),s!==i?(o=bs(),o!==i?(u=Rs(),u!==i?(e.charCodeAt(qi)===42?(a=rt,qi++):(a=i,Xi===0&&Zi(it)),a!==i?(f=Rs(),f!==i?(Ri=t,n=ot(r,o),t=n):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)))),t}function vs(){var t,n,r,s,o,c,h,p,d,v,m,g,y,b,w,E;return t=qi,n=Rs(),n!==i?(r=As(),r!==i?(s=Rs(),s!==i?(o=xs(),o!==i?(c=Rs(),c!==i?(h=As(),h!==i?(p=Rs(),p!==i?(d=qi,e.charCodeAt(qi)===91?(v=z,qi++):(v=i,Xi===0&&Zi(W)),v!==i?(m=Ts(),m!==i?(e.charCodeAt(qi)===93?(g=X,qi++):(g=i,Xi===0&&Zi(V)),g!==i?(Ri=d,v=ut(r,o,h,m),d=v):(qi=d,d=i)):(qi=d,d=i)):(qi=d,d=i),d===i&&(d=null),d!==i?(v=Rs(),v!==i?(e.charCodeAt(qi)===123?(m=u,qi++):(m=i,Xi===0&&Zi(a)),m!==i?(g=Rs(),g!==i?(y=as(),y===i&&(y=null),y!==i?(b=Rs(),b!==i?(e.charCodeAt(qi)===125?(w=f,qi++):(w=i,Xi===0&&Zi(l)),w!==i?(E=Rs(),E!==i?(Ri=t,n=at(r,o,h,d,y),t=n):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i),t}function ms(){var t,n;return Xi++,e.substr(qi,3)===lt?(t=lt,qi+=3):(t=i,Xi===0&&Zi(ct)),t===i&&(e.substr(qi,3)===ht?(t=ht,qi+=3):(t=i,Xi===0&&Zi(pt))),Xi--,t===i&&(n=i,Xi===0&&Zi(ft)),t}function gs(){var t,n;return Xi++,e.substr(qi,3)===vt?(t=vt,qi+=3):(t=i,Xi===0&&Zi(mt)),Xi--,t===i&&(n=i,Xi===0&&Zi(dt)),t}function ys(){var e,t;return e=qi,t=bs(),t===i&&(t=ws(),t===i&&(t=Es(),t===i&&(t=Ss()))),t!==i&&(Ri=e,t=gt(t)),e=t,e}function bs(){var t,n;return Xi++,e.substr(qi,2)===bt?(t=bt,qi+=2):(t=i,Xi===0&&Zi(wt)),t===i&&(e.substr(qi,3)===Et?(t=Et,qi+=3):(t=i,Xi===0&&Zi(St)),t===i&&(e.substr(qi,2)===xt?(t=xt,qi+=2):(t=i,Xi===0&&Zi(Tt)),t===i&&(e.substr(qi,5)===Nt?(t=Nt,qi+=5):(t=i,Xi===0&&Zi(Ct)),t===i&&(e.substr(qi,3)===kt?(t=kt,qi+=3):(t=i,Xi===0&&Zi(Lt)),t===i&&(e.substr(qi,2)===At?(t=At,qi+=2):(t=i,Xi===0&&Zi(Ot)),t===i&&(e.substr(qi,4)===Mt?(t=Mt,qi+=4):(t=i,Xi===0&&Zi(_t)),t===i&&(e.substr(qi,2)===Dt?(t=Dt,qi+=2):(t=i,Xi===0&&Zi(Pt)),t===i&&(e.substr(qi,3)===Ht?(t=Ht,qi+=3):(t=i,Xi===0&&Zi(Bt)))))))))),Xi--,t===i&&(n=i,Xi===0&&Zi(yt)),t}function ws(){var t,n;return Xi++,e.substr(qi,2)===Ft?(t=Ft,qi+=2):(t=i,Xi===0&&Zi(It)),t===i&&(e.substr(qi,3)===qt?(t=qt,qi+=3):(t=i,Xi===0&&Zi(Rt)),t===i&&(e.substr(qi,2)===Ut?(t=Ut,qi+=2):(t=i,Xi===0&&Zi(zt)),t===i&&(e.substr(qi,2)===Wt?(t=Wt,qi+=2):(t=i,Xi===0&&Zi(Xt)),t===i&&(e.substr(qi,2)===Vt?(t=Vt,qi+=2):(t=i,Xi===0&&Zi($t)),t===i&&(e.substr(qi,2).toLowerCase()===Jt?(t=e.substr(qi,2),qi+=2):(t=i,Xi===0&&Zi(Kt))))))),Xi--,t===i&&(n=i,Xi===0&&Zi(jt)),t}function Es(){var t,n;return Xi++,e.substr(qi,2)===Gt?(t=Gt,qi+=2):(t=i,Xi===0&&Zi(Yt)),t===i&&(e.substr(qi,3)===Zt?(t=Zt,qi+=3):(t=i,Xi===0&&Zi(en)),t===i&&(e.substr(qi,2)===tn?(t=tn,qi+=2):(t=i,Xi===0&&Zi(nn)),t===i&&(e.substr(qi,2)===rn?(t=rn,qi+=2):(t=i,Xi===0&&Zi(sn)),t===i&&(e.substr(qi,2)===on?(t=on,qi+=2):(t=i,Xi===0&&Zi(un)),t===i&&(e.substr(qi,2).toLowerCase()===an?(t=e.substr(qi,2),qi+=2):(t=i,Xi===0&&Zi(fn))))))),Xi--,t===i&&(n=i,Xi===0&&Zi(Qt)),t}function Ss(){var t,n;return Xi++,e.substr(qi,4).toLowerCase()===cn?(t=e.substr(qi,4),qi+=4):(t=i,Xi===0&&Zi(hn)),t===i&&(e.substr(qi,4).toLowerCase()===pn?(t=e.substr(qi,4),qi+=4):(t=i,Xi===0&&Zi(dn)),t===i&&(e.substr(qi,4).toLowerCase()===vn?(t=e.substr(qi,4),qi+=4):(t=i,Xi===0&&Zi(mn)),t===i&&(e.substr(qi,3).toLowerCase()===gn?(t=e.substr(qi,3),qi+=3):(t=i,Xi===0&&Zi(yn))))),Xi--,t===i&&(n=i,Xi===0&&Zi(ln)),t}function xs(){var t,n;return Xi++,t=qi,e.substr(qi,3).toLowerCase()===wn?(n=e.substr(qi,3),qi+=3):(n=i,Xi===0&&Zi(En)),n===i&&(e.substr(qi,4).toLowerCase()===Sn?(n=e.substr(qi,4),qi+=4):(n=i,Xi===0&&Zi(xn)),n===i&&(e.substr(qi,3).toLowerCase()===Tn?(n=e.substr(qi,3),qi+=3):(n=i,Xi===0&&Zi(Nn)),n===i&&(e.substr(qi,5).toLowerCase()===Cn?(n=e.substr(qi,5),qi+=5):(n=i,Xi===0&&Zi(kn)),n===i&&(e.substr(qi,3).toLowerCase()===Ln?(n=e.substr(qi,3),qi+=3):(n=i,Xi===0&&Zi(An)),n===i&&(e.substr(qi,3).toLowerCase()===On?(n=e.substr(qi,3),qi+=3):(n=i,Xi===0&&Zi(Mn)),n===i&&(e.substr(qi,6).toLowerCase()===_n?(n=e.substr(qi,6),qi+=6):(n=i,Xi===0&&Zi(Dn)),n===i&&(e.substr(qi,3).toLowerCase()===Pn?(n=e.substr(qi,3),qi+=3):(n=i,Xi===0&&Zi(Hn)),n===i&&(e.substr(qi,8).toLowerCase()===Bn?(n=e.substr(qi,8),qi+=8):(n=i,Xi===0&&Zi(jn)),n===i&&(e.substr(qi,6).toLowerCase()===Fn?(n=e.substr(qi,6),qi+=6):(n=i,Xi===0&&Zi(In)),n===i&&(e.substr(qi,8).toLowerCase()===qn?(n=e.substr(qi,8),qi+=8):(n=i,Xi===0&&Zi(Rn)),n===i&&(e.substr(qi,6).toLowerCase()===Un?(n=e.substr(qi,6),qi+=6):(n=i,Xi===0&&Zi(zn)),n===i&&(e.substr(qi,4).toLowerCase()===Wn?(n=e.substr(qi,4),qi+=4):(n=i,Xi===0&&Zi(Xn)),n===i&&(e.substr(qi,3).toLowerCase()===Vn?(n=e.substr(qi,3),qi+=3):(n=i,Xi===0&&Zi($n)),n===i&&(e.substr(qi,3).toLowerCase()===Jn?(n=e.substr(qi,3),qi+=3):(n=i,Xi===0&&Zi(Kn)))))))))))))))),n!==i&&(Ri=t,n=Qn(n)),t=n,Xi--,t===i&&(n=i,Xi===0&&Zi(bn)),t}function Ts(){var t,n,r,s,o,u;t=qi,n=qi,r=[],s=qi,o=Ns(),o!==i?(e.charCodeAt(qi)===44?(u=b,qi++):(u=i,Xi===0&&Zi(w)),u!==i?(Ri=s,o=Q(o),s=o):(qi=s,s=i)):(qi=s,s=i);while(s!==i)r.push(s),s=qi,o=Ns(),o!==i?(e.charCodeAt(qi)===44?(u=b,qi++):(u=i,Xi===0&&Zi(w)),u!==i?(Ri=s,o=Q(o),s=o):(qi=s,s=i)):(qi=s,s=i);return r!==i?(s=qi,o=Ns(),o!==i&&(Ri=s,o=Q(o)),s=o,s!==i?(r=[r,s],n=r):(qi=n,n=i)):(qi=n,n=i),n!==i&&(Ri=t,n=T(n)),t=n,t}function Ns(){var t,n,r,s,o,u,a,f;return t=qi,n=Rs(),n!==i?(r=Cs(),r!==i?(s=Rs(),s!==i?(e.charCodeAt(qi)===61?(o=O,qi++):(o=i,Xi===0&&Zi(M)),o!==i?(u=Rs(),u!==i?(a=As(),a!==i?(f=Rs(),f!==i?(Ri=t,n=Gn(r,a),t=n):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i),t}function Cs(){var t,n;return Xi++,e.substr(qi,5).toLowerCase()===Zn?(t=e.substr(qi,5),qi+=5):(t=i,Xi===0&&Zi(er)),t===i&&(e.substr(qi,5).toLowerCase()===tr?(t=e.substr(qi,5),qi+=5):(t=i,Xi===0&&Zi(nr)),t===i&&(e.substr(qi,2).toLowerCase()===rr?(t=e.substr(qi,2),qi+=2):(t=i,Xi===0&&Zi(ir)),t===i&&(e.substr(qi,3).toLowerCase()===sr?(t=e.substr(qi,3),qi+=3):(t=i,Xi===0&&Zi(or)),t===i&&(e.substr(qi,9).toLowerCase()===ur?(t=e.substr(qi,9),qi+=9):(t=i,Xi===0&&Zi(ar)),t===i&&(e.substr(qi,10).toLowerCase()===fr?(t=e.substr(qi,10),qi+=10):(t=i,Xi===0&&Zi(lr)),t===i&&(e.substr(qi,9).toLowerCase()===cr?(t=e.substr(qi,9),qi+=9):(t=i,Xi===0&&Zi(hr)),t===i&&(e.substr(qi,10).toLowerCase()===pr?(t=e.substr(qi,10),qi+=10):(t=i,Xi===0&&Zi(dr)),t===i&&(e.substr(qi,11).toLowerCase()===vr?(t=e.substr(qi,11),qi+=11):(t=i,Xi===0&&Zi(mr)),t===i&&(e.substr(qi,12).toLowerCase()===gr?(t=e.substr(qi,12),qi+=12):(t=i,Xi===0&&Zi(yr)),t===i&&(e.substr(qi,12).toLowerCase()===br?(t=e.substr(qi,12),qi+=12):(t=i,Xi===0&&Zi(wr)),t===i&&(e.substr(qi,13).toLowerCase()===Er?(t=e.substr(qi,13),qi+=13):(t=i,Xi===0&&Zi(Sr)),t===i&&(e.substr(qi,12).toLowerCase()===xr?(t=e.substr(qi,12),qi+=12):(t=i,Xi===0&&Zi(Tr)),t===i&&(e.substr(qi,13).toLowerCase()===Nr?(t=e.substr(qi,13),qi+=13):(t=i,Xi===0&&Zi(Cr)),t===i&&(e.substr(qi,14).toLowerCase()===kr?(t=e.substr(qi,14),qi+=14):(t=i,Xi===0&&Zi(Lr)),t===i&&(e.substr(qi,15).toLowerCase()===Ar?(t=e.substr(qi,15),qi+=15):(t=i,Xi===0&&Zi(Or)),t===i&&(e.substr(qi,7).toLowerCase()===Mr?(t=e.substr(qi,7),qi+=7):(t=i,Xi===0&&Zi(_r)))))))))))))))))),Xi--,t===i&&(n=i,Xi===0&&Zi(Yn)),t}function ks(){var t,n,r,s;return Xi++,t=qi,e.charCodeAt(qi)===34?(n=Pr,qi++):(n=i,Xi===0&&Zi(Hr)),n!==i?(r=Ls(),r!==i?(e.charCodeAt(qi)===34?(s=Pr,qi++):(s=i,Xi===0&&Zi(Hr)),s!==i?(Ri=t,n=Br(r),t=n):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i),Xi--,t===i&&(n=i,Xi===0&&Zi(Dr)),t}function Ls(){var t,n,r,s;t=[],n=qi,r=qi,Xi++,e.charCodeAt(qi)===34?(s=Pr,qi++):(s=i,Xi===0&&Zi(Hr)),Xi--,s===i?r=void 0:(qi=r,r=i),r!==i?(e.substr(qi,2)===jr?(s=jr,qi+=2):(s=i,Xi===0&&Zi(Fr)),s===i&&(e.length>qi?(s=e.charAt(qi),qi++):(s=i,Xi===0&&Zi(Ir))),s!==i?(Ri=n,r=qr(s),n=r):(qi=n,n=i)):(qi=n,n=i);while(n!==i)t.push(n),n=qi,r=qi,Xi++,e.charCodeAt(qi)===34?(s=Pr,qi++):(s=i,Xi===0&&Zi(Hr)),Xi--,s===i?r=void 0:(qi=r,r=i),r!==i?(e.substr(qi,2)===jr?(s=jr,qi+=2):(s=i,Xi===0&&Zi(Fr)),s===i&&(e.length>qi?(s=e.charAt(qi),qi++):(s=i,Xi===0&&Zi(Ir))),s!==i?(Ri=n,r=qr(s),n=r):(qi=n,n=i)):(qi=n,n=i);return t}function As(){var e,t;return Xi++,e=Os(),e===i&&(e=ks()),Xi--,e===i&&(t=i,Xi===0&&Zi(Rr)),e}function Os(){var t,n,r;t=qi,n=[],Ur.test(e.charAt(qi))?(r=e.charAt(qi),qi++):(r=i,Xi===0&&Zi(zr));if(r!==i)while(r!==i)n.push(r),Ur.test(e.charAt(qi))?(r=e.charAt(qi),qi++):(r=i,Xi===0&&Zi(zr));else n=i;return n!==i&&(Ri=t,n=Wr(n)),t=n,t}function Ms(){var t,n;return Xi++,t=qi,Vr.test(e.charAt(qi))?(n=e.charAt(qi),qi++):(n=i,Xi===0&&Zi($r)),n!==i&&(Ri=t,n=qr(n)),t=n,Xi--,t===i&&(n=i,Xi===0&&Zi(Xr)),t}function _s(){var t,n;return Xi++,t=qi,Kr.test(e.charAt(qi))?(n=e.charAt(qi),qi++):(n=i,Xi===0&&Zi(Qr)),n!==i&&(Ri=t,n=qr(n)),t=n,Xi--,t===i&&(n=i,Xi===0&&Zi(Jr)),t}function Ds(){var t;return e.substr(qi,2)===Gr?(t=Gr,qi+=2):(t=i,Xi===0&&Zi(Yr)),t}function Ps(){var t;return e.substr(qi,2)===Zr?(t=Zr,qi+=2):(t=i,Xi===0&&Zi(ei)),t}function Hs(){var t,n,r;return t=qi,n=qi,Xi++,e.substr(qi,2)===Zr?(r=Zr,qi+=2):(r=i,Xi===0&&Zi(ei)),Xi--,r===i?n=void 0:(qi=n,n=i),n!==i?(e.length>qi?(r=e.charAt(qi),qi++):(r=i,Xi===0&&Zi(Ir)),r!==i?(Ri=t,n=qr(r),t=n):(qi=t,t=i)):(qi=t,t=i),t}function Bs(){var e,t,n,r;e=qi,t=Ds();if(t!==i){n=[],r=Hs();while(r!==i)n.push(r),r=Hs();n!==i?(r=Ps(),r!==i?(Ri=e,t=ti(t,n,r),e=t):(qi=e,e=i)):(qi=e,e=i)}else qi=e,e=i;return e}function js(){var t;return e.substr(qi,2)===ni?(t=ni,qi+=2):(t=i,Xi===0&&Zi(ri)),t===i&&(e.charCodeAt(qi)===35?(t=ii,qi++):(t=i,Xi===0&&Zi(si))),t}function Fs(){var t;return oi.test(e.charAt(qi))?(t=e.charAt(qi),qi++):(t=i,Xi===0&&Zi(ui)),t}function Is(){var e,t,n,r;e=qi,t=js();if(t!==i){n=[],r=Fs();while(r!==i)n.push(r),r=Fs();n!==i?(Ri=e,t=ai(t,n),e=t):(qi=e,e=i)}else qi=e,e=i;return e}function qs(){var e,t;return Xi++,e=Is(),e===i&&(e=Bs()),Xi--,e===i&&(t=i,Xi===0&&Zi(fi)),e}function Rs(){var e,t;e=[],t=Ms(),t===i&&(t=_s(),t===i&&(t=qs()));while(t!==i)e.push(t),t=Ms(),t===i&&(t=_s(),t===i&&(t=qs()));return e}function Us(){var e,t;return Xi++,e=qi,t=zs(),t!==i&&(Ri=e,t=ci(t)),e=t,e===i&&(e=qi,t=Ws(),t!==i&&(Ri=e,t=hi(t)),e=t),Xi--,e===i&&(t=i,Xi===0&&Zi(li)),e}function zs(){var t,n,r,s;return t=qi,e.charCodeAt(qi)===34?(n=Pr,qi++):(n=i,Xi===0&&Zi(Hr)),n!==i?(r=Ws(),r!==i?(e.charCodeAt(qi)===34?(s=Pr,qi++):(s=i,Xi===0&&Zi(Hr)),s!==i?(Ri=t,n=pi(r),t=n):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i),t}function Ws(){var e;return e=Vs(),e===i&&(e=Xs()),e}function Xs(){var t,n,r;t=qi,n=[],di.test(e.charAt(qi))?(r=e.charAt(qi),qi++):(r=i,Xi===0&&Zi(vi));if(r!==i)while(r!==i)n.push(r),di.test(e.charAt(qi))?(r=e.charAt(qi),qi++):(r=i,Xi===0&&Zi(vi));else n=i;return n!==i&&(Ri=t,n=mi(n)),t=n,t}function Vs(){var t,n,r,s,o;return t=qi,n=qi,r=Xs(),r!==i?(e.charCodeAt(qi)===46?(s=gi,qi++):(s=i,Xi===0&&Zi(yi)),s!==i?(o=Xs(),o!==i?(r=[r,s,o],n=r):(qi=n,n=i)):(qi=n,n=i)):(qi=n,n=i),n!==i&&(Ri=t,n=bi(n)),t=n,t}function $s(){var e,t;return Xi++,e=qi,t=Js(),t!==i&&(Ri=e,t=Ei(t)),e=t,e===i&&(e=qi,t=Ks(),t!==i&&(Ri=e,t=Si(t)),e=t),Xi--,e===i&&(t=i,Xi===0&&Zi(wi)),e}function Js(){var t,n,r,s;return t=qi,e.charCodeAt(qi)===34?(n=Pr,qi++):(n=i,Xi===0&&Zi(Hr)),n!==i?(r=Ks(),r!==i?(e.charCodeAt(qi)===34?(s=Pr,qi++):(s=i,Xi===0&&Zi(Hr)),s!==i?(Ri=t,n=ci(r),t=n):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i),t}function Ks(){var t;return e.substr(qi,4).toLowerCase()===xi?(t=e.substr(qi,4),qi+=4):(t=i,Xi===0&&Zi(Ti)),t===i&&(e.substr(qi,5).toLowerCase()===Ni?(t=e.substr(qi,5),qi+=5):(t=i,Xi===0&&Zi(Ci)),t===i&&(e.substr(qi,2).toLowerCase()===ki?(t=e.substr(qi,2),qi+=2):(t=i,Xi===0&&Zi(Li)),t===i&&(e.substr(qi,3).toLowerCase()===Ai?(t=e.substr(qi,3),qi+=3):(t=i,Xi===0&&Zi(Oi)),t===i&&(e.charCodeAt(qi)===48?(t=Mi,qi++):(t=i,Xi===0&&Zi(_i)),t===i&&(e.charCodeAt(qi)===49?(t=Di,qi++):(t=i,Xi===0&&Zi(Pi))))))),t}function Qs(){var e,t;return Xi++,e=Gs(),e===i&&(e=Ys()),Xi--,e===i&&(t=i,Xi===0&&Zi(Hi)),e}function Gs(){var t,n,r,s;return t=qi,e.charCodeAt(qi)===34?(n=Pr,qi++):(n=i,Xi===0&&Zi(Hr)),n!==i?(r=Ys(),r!==i?(e.charCodeAt(qi)===34?(s=Pr,qi++):(s=i,Xi===0&&Zi(Hr)),s!==i?(Ri=t,n=ci(r),t=n):(qi=t,t=i)):(qi=t,t=i)):(qi=t,t=i),t}function Ys(){var t,n;return t=qi,n=Ws(),n!==i&&(Ri=t,n=Bi(n)),t=n,t===i&&(t=qi,e.substr(qi,4).toLowerCase()===ji?(n=e.substr(qi,4),qi+=4):(n=i,Xi===0&&Zi(Fi)),n!==i&&(Ri=t,n=Ii(n)),t=n),t}function Zs(e,t){t&&Object.getOwnPropertyNames(t).forEach(function(n){e[n]=t[n]})}function eo(e,t){return e=e?e:{},Zs(e,t),e}function to(e){var t={};return e[0].forEach(function(e){t=eo(t,e)}),eo(t,e[1])}function no(e){return["true","on","1"].indexOf(e.toLowerCase())>-1}function ro(e,t){var n={};return n[e.toLowerCase()]=t,n}function io(e,t){return t===undefined||t==="*"||e.entities.some(function(e){return e.name===t})}function so(e){return["box","abox","rbox","note","msc","hscale","width","arcgradient","wordwraparcs","label","color","idurl","id","url","linecolor","linecolour","textcolor","textcolour","textbgcolor","textbgcolour","arclinecolor","arclinecolour","arctextcolor","arctextcolour","arctextbgcolor","arctextbgcolour","arcskip"].indexOf(e)>-1}function oo(e,t){return"Entity '"+e+"' in arc "+"'"+t.from+" "+t.kind+" "+t.to+"' "+"is not defined."}function uo(e,t){this.name="EntityNotDefinedError",this.message=oo(e,t),!t.location||(this.location=t.location,this.location.start.line++,this.location.end.line++)}function ao(e,t){return e||(e={},e.entities=[]),t&&t.arcs&&t.arcs.forEach(function(t){t.forEach(function(t){if(t.from&&!io(e,t.from))throw new uo(t.from,t);if(t.to&&!io(e,t.to))throw new uo(t.to,t);!t.location||delete t.location,!t.arcs||ao(e,t)})}),e}function fo(e){return e&&e.options?!!e.options.watermark||!!e.options.width&&e.options.width==="auto":!1}function lo(e){return e&&e.arcs?e.arcs.some(function(e){return e.some(function(e){return["alt","else","opt","break","par","seq","strict","neg","critical","ignore","consider","assert","loop","ref","exc"].indexOf(e.kind)>-1})}):!1}function co(e,t){var n=fo(e),r=lo(t);return{extendedOptions:n,extendedArcTypes:r,extendedFeatures:n||r}}var n=arguments.length>1?arguments[1]:{},r=this,i={},s={program:ts},o=ts,u="{",a={type:"literal",value:"{",description:'"{"'},f="}",l={type:"literal",value:"}",description:'"}"'},c=function(e,t){t[1]=ao(t[1],t[2]);var n=eo(t[0],eo(t[1],t[2]));return n=eo({meta:co(t[0],t[2])},n),e.length>0&&(n=eo({precomment:e},n)),n},h="msc",p={type:"literal",value:"msc",description:'"msc"'},d="xu",v={type:"literal",value:"xu",description:'"xu"'},m=function(e){return{options:e}},g=function(e){return{entities:e}},y=function(e){return{arcs:e}},b=",",w={type:"literal",value:",",description:'","'},E=function(e){return e},S=";",x={type:"literal",value:";",description:'";"'},T=function(e){return to(e)},N={type:"other",description:"option"},C="hscale",k={type:"literal",value:"hscale",description:'"hscale"'},L="arcgradient",A={type:"literal",value:"arcgradient",description:'"arcgradient"'},O="=",M={type:"literal",value:"=",description:'"="'},_=function(e,t){return ro(e,t)},D="width",P={type:"literal",value:"width",description:'"width"'},H="wordwraparcs",B={type:"literal",value:"wordwraparcs",description:'"wordwraparcs"'},j=function(e,t){var n={};return n[e.toLowerCase()]=no(t),n},F="watermark",I={type:"literal",value:"watermark",description:'"watermark"'},q=function(e){return e},R=function(e){return e[0].push(e[1]),e[0]},U={type:"other",description:"entity"},z="[",W={type:"literal",value:"[",description:'"["'},X="]",V={type:"literal",value:"]",description:'"]"'},$=function(e,t){return t},J=function(e,t){return eo({name:e},t)},K=function(e,t){return so(e)&&Qi("MscGen keywords aren't allowed as entity names (embed them in quotes if you need them)"),eo({name:e},t)},Q=function(e){return e},G=function(e){return[e]},Y=function(e){return e[0].push(e[1][0]),e[0]},Z=function(e,t){return t},et=function(e,t){return eo(e,t)},tt=function(e){return{kind:e}},nt=function(e,t,n){return{kind:t,from:e,to:n,location:Ji()}},rt="*",it={type:"literal",value:"*",description:'"*"'},st=function(e,t){return{kind:e,from:"*",to:t,location:Ji()}},ot=function(e,t){return{kind:t,from:e,to:"*",location:Ji()}},ut=function(e,t,n,r){return r},at=function(e,t,n,r,i){var s={kind:t,from:e,to:n,location:Ji(),arcs:i};return eo(s,r)},ft={type:"other",description:"empty row"},lt="|||",ct={type:"literal",value:"|||",description:'"|||"'},ht="...",pt={type:"literal",value:"...",description:'"..."'},dt={type:"other",description:"---"},vt="---",mt={type:"literal",value:"---",description:'"---"'},gt=function(e){return e.toLowerCase()},yt={type:"other",description:"bi-directional arrow"},bt="--",wt={type:"literal",value:"--",description:'"--"'},Et="<->",St={type:"literal",value:"<->",description:'"<->"'},xt="==",Tt={type:"literal",value:"==",description:'"=="'},Nt="<<=>>",Ct={type:"literal",value:"<<=>>",description:'"<<=>>"'},kt="<=>",Lt={type:"literal",value:"<=>",description:'"<=>"'},At="..",Ot={type:"literal",value:"..",description:'".."'},Mt="<<>>",_t={type:"literal",value:"<<>>",description:'"<<>>"'},Dt="::",Pt={type:"literal",value:"::",description:'"::"'},Ht="<:>",Bt={type:"literal",value:"<:>",description:'"<:>"'},jt={type:"other",description:"left to right arrow"},Ft="->",It={type:"literal",value:"->",description:'"->"'},qt="=>>",Rt={type:"literal",value:"=>>",description:'"=>>"'},Ut="=>",zt={type:"literal",value:"=>",description:'"=>"'},Wt=">>",Xt={type:"literal",value:">>",description:'">>"'},Vt=":>",$t={type:"literal",value:":>",description:'":>"'},Jt="-x",Kt={type:"literal",value:"-x",description:'"-x"'},Qt={type:"other",description:"right to left arrow"},Gt="<-",Yt={type:"literal",value:"<-",description:'"<-"'},Zt="<<=",en={type:"literal",value:"<<=",description:'"<<="'},tn="<=",nn={type:"literal",value:"<=",description:'"<="'},rn="<<",sn={type:"literal",value:"<<",description:'"<<"'},on="<:",un={type:"literal",value:"<:",description:'"<:"'},an="x-",fn={type:"literal",value:"x-",description:'"x-"'},ln={type:"other",description:"box"},cn="note",hn={type:"literal",value:"note",description:'"note"'},pn="abox",dn={type:"literal",value:"abox",description:'"abox"'},vn="rbox",mn={type:"literal",value:"rbox",description:'"rbox"'},gn="box",yn={type:"literal",value:"box",description:'"box"'},bn={type:"other",description:"inline expression"},wn="alt",En={type:"literal",value:"alt",description:'"alt"'},Sn="else",xn={type:"literal",value:"else",description:'"else"'},Tn="opt",Nn={type:"literal",value:"opt",description:'"opt"'},Cn="break",kn={type:"literal",value:"break",description:'"break"'},Ln="par",An={type:"literal",value:"par",description:'"par"'},On="seq",Mn={type:"literal",value:"seq",description:'"seq"'},_n="strict",Dn={type:"literal",value:"strict",description:'"strict"'},Pn="neg",Hn={type:"literal",value:"neg",description:'"neg"'},Bn="critical",jn={type:"literal",value:"critical",description:'"critical"'},Fn="ignore",In={type:"literal",value:"ignore",description:'"ignore"'},qn="consider",Rn={type:"literal",value:"consider",description:'"consider"'},Un="assert",zn={type:"literal",value:"assert",description:'"assert"'},Wn="loop",Xn={type:"literal",value:"loop",description:'"loop"'},Vn="ref",$n={type:"literal",value:"ref",description:'"ref"'},Jn="exc",Kn={type:"literal",value:"exc",description:'"exc"'},Qn=function(e){return e.toLowerCase()},Gn=function(e,t){var n={};return n[e.toLowerCase().replace("colour","color")]=t,n},Yn={type:"other",description:"attribute name"},Zn="label",er={type:"literal",value:"label",description:'"label"'},tr="idurl",nr={type:"literal",value:"idurl",description:'"idurl"'},rr="id",ir={type:"literal",value:"id",description:'"id"'},sr="url",or={type:"literal",value:"url",description:'"url"'},ur="linecolor",ar={type:"literal",value:"linecolor",description:'"linecolor"'},fr="linecolour",lr={type:"literal",value:"linecolour",description:'"linecolour"'},cr="textcolor",hr={type:"literal",value:"textcolor",description:'"textcolor"'},pr="textcolour",dr={type:"literal",value:"textcolour",description:'"textcolour"'},vr="textbgcolor",mr={type:"literal",value:"textbgcolor",description:'"textbgcolor"'},gr="textbgcolour",yr={type:"literal",value:"textbgcolour",description:'"textbgcolour"'},br="arclinecolor",wr={type:"literal",value:"arclinecolor",description:'"arclinecolor"'},Er="arclinecolour",Sr={type:"literal",value:"arclinecolour",description:'"arclinecolour"'},xr="arctextcolor",Tr={type:"literal",value:"arctextcolor",description:'"arctextcolor"'},Nr="arctextcolour",Cr={type:"literal",value:"arctextcolour",description:'"arctextcolour"'},kr="arctextbgcolor",Lr={type:"literal",value:"arctextbgcolor",description:'"arctextbgcolor"'},Ar="arctextbgcolour",Or={type:"literal",value:"arctextbgcolour",description:'"arctextbgcolour"'},Mr="arcskip",_r={type:"literal",value:"arcskip",description:'"arcskip"'},Dr={type:"other",description:"double quoted string"},Pr='"',Hr={type:"literal",value:'"',description:'"\\""'},Br=function(e){return e.join("")},jr='\\"',Fr={type:"literal",value:'\\"',description:'"\\\\\\""'},Ir={type:"any",description:"any character"},qr=function(e){return e},Rr={type:"other",description:"identifier"},Ur=/^[A-Za-z_0-9]/,zr={type:"class",value:"[A-Za-z_0-9]",description:"[A-Za-z_0-9]"},Wr=function(e){return e.join("")},Xr={type:"other",description:"whitespace"},Vr=/^[ \t]/,$r={type:"class",value:"[ \\t]",description:"[ \\t]"},Jr={type:"other",description:"lineend"},Kr=/^[\r\n]/,Qr={type:"class",value:"[\\r\\n]",description:"[\\r\\n]"},Gr="/*",Yr={type:"literal",value:"/*",description:'"/*"'},Zr="*/",ei={type:"literal",value:"*/",description:'"*/"'},ti=function(e,t,n){return e+t.join("")+n},ni="//",ri={type:"literal",value:"//",description:'"//"'},ii="#",si={type:"literal",value:"#",description:'"#"'},oi=/^[^\r\n]/,ui={type:"class",value:"[^\\r\\n]",description:"[^\\r\\n]"},ai=function(e,t){return e+t.join("")},fi={type:"other",description:"comment"},li={type:"other",description:"number"},ci=function(e){return e},hi=function(e){return e.toString()},pi=function(e){return e.toString()},di=/^[0-9]/,vi={type:"class",value:"[0-9]",description:"[0-9]"},mi=function(e){return parseInt(e.join(""),10)},gi=".",yi={type:"literal",value:".",description:'"."'},bi=function(e){return parseFloat(e.join(""))},wi={type:"other",description:"boolean"},Ei=function(e){return e},Si=function(e){return e.toString()},xi="true",Ti={type:"literal",value:"true",description:'"true"'},Ni="false",Ci={type:"literal",value:"false",description:'"false"'},ki="on",Li={type:"literal",value:"on",description:'"on"'},Ai="off",Oi={type:"literal",value:"off",description:'"off"'},Mi="0",_i={type:"literal",value:"0",description:'"0"'},Di="1",Pi={type:"literal",value:"1",description:'"1"'},Hi={type:"other",description:"size"},Bi=function(e){return e.toString()},ji="auto",Fi={type:"literal",value:"auto",description:'"auto"'},Ii=function(e){return e.toLowerCase()},qi=0,Ri=0,Ui=[{line:1,column:1,seenCR:!1}],zi=0,Wi=[],Xi=0,Vi;if("startRule"in n){if(!(n.startRule in s))throw new Error("Can't start parsing from rule \""+n.startRule+'".');o=s[n.startRule]}Vi=o();if(Vi!==i&&qi===e.length)return Vi;throw Vi!==i&&qi<e.length&&Zi({type:"end",description:"end of input"}),es(null,Wi,zi<e.length?e.charAt(zi):null,zi<e.length?Yi(zi,zi+1):Yi(zi,zi))}return e(t,Error),{SyntaxError:t,parse:n}}),n("lib/mscgenjs-core/parse/msgennyparser",[],function(){"use strict";function e(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}function t(e,n,r,i){this.message=e,this.expected=n,this.found=r,this.location=i,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,t)}function n(e){function ui(){return e.substring(ti,ei)}function ai(){return hi(ti,ei)}function fi(t){throw di(null,[{type:"other",description:t}],e.substring(ti,ei),hi(ti,ei))}function li(t){throw di(t,null,e.substring(ti,ei),hi(ti,ei))}function ci(t){var n=ni[t],r,i;if(n)return n;r=t-1;while(!ni[r])r--;n=ni[r],n={line:n.line,column:n.column,seenCR:n.seenCR};while(r<t)i=e.charAt(r),i==="\n"?(n.seenCR||n.line++,n.column=1,n.seenCR=!1):i==="\r"||i==="\u2028"||i==="\u2029"?(n.line++,n.column=1,n.seenCR=!0):(n.column++,n.seenCR=!1),r++;return ni[t]=n,n}function hi(e,t){var n=ci(e),r=ci(t);return{start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:r.line,column:r.column}}}function pi(e){if(ei<ri)return;ei>ri&&(ri=ei,ii=[]),ii.push(e)}function di(e,n,r,i){function s(e){var t=1;e.sort(function(e,t){return e.description<t.description?-1:e.description>t.description?1:0});while(t<e.length)e[t-1]===e[t]?e.splice(t,1):t++}function o(e,t){function n(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+t(e)}).replace(/[\u0100-\u0FFF]/g,function(e){return"\\u0"+t(e)}).replace(/[\u1000-\uFFFF]/g,function(e){return"\\u"+t(e)})}var r=new Array(e.length),i,s,o;for(o=0;o<e.length;o++)r[o]=e[o].description;return i=e.length>1?r.slice(0,-1).join(", ")+" or "+r[e.length-1]:r[0],s=t?'"'+n(t)+'"':"end of input","Expected "+i+" but "+s+" found."}return n!==null&&s(n),new t(e!==null?e:o(n,r),n,r,i)}function vi(){var e,t,n,r;return e=ei,t=Zi(),t!==i?(n=mi(),n!==i?(r=Zi(),r!==i?(ti=e,t=u(t,n),e=t):(ei=e,e=i)):(ei=e,e=i)):(ei=e,e=i),e}function mi(){var e,t,n,r,s;return e=ei,t=ei,n=gi(),n!==i&&(ti=t,n=a(n)),t=n,t===i&&(t=null),t!==i?(n=ei,r=bi(),r!==i&&(ti=n,r=f(r)),n=r,n===i&&(n=null),n!==i?(r=ei,s=Ei(),s!==i&&(ti=r,s=l(s)),r=s,r===i&&(r=null),r!==i?(t=[t,n,r],e=t):(ei=e,e=i)):(ei=e,e=i)):(ei=e,e=i),e}function gi(){var t,n,r,s,o,u;t=ei,n=ei,r=[],s=ei,o=yi(),o!==i?(e.charCodeAt(ei)===44?(u=c,ei++):(u=i,si===0&&pi(h)),u!==i?(ti=s,o=p(o),s=o):(ei=s,s=i)):(ei=s,s=i);while(s!==i)r.push(s),s=ei,o=yi(),o!==i?(e.charCodeAt(ei)===44?(u=c,ei++):(u=i,si===0&&pi(h)),u!==i?(ti=s,o=p(o),s=o):(ei=s,s=i)):(ei=s,s=i);return r!==i?(s=ei,o=yi(),o!==i?(e.charCodeAt(ei)===59?(u=d,ei++):(u=i,si===0&&pi(v)),u!==i?(ti=s,o=p(o),s=o):(ei=s,s=i)):(ei=s,s=i),s!==i?(r=[r,s],n=r):(ei=n,n=i)):(ei=n,n=i),n!==i&&(ti=t,n=m(n)),t=n,t}function yi(){var t,n,r,s,o,u,a,f;return t=ei,n=Zi(),n!==i?(e.substr(ei,6).toLowerCase()===g?(r=e.substr(ei,6),ei+=6):(r=i,si===0&&pi(y)),r===i&&(e.substr(ei,11).toLowerCase()===b?(r=e.substr(ei,11),ei+=11):(r=i,si===0&&pi(w))),r!==i?(s=Zi(),s!==i?(e.charCodeAt(ei)===61?(o=E,ei++):(o=i,si===0&&pi(S)),o!==i?(u=Zi(),u!==i?(a=es(),a!==i?(f=Zi(),f!==i?(ti=t,n=x(r,a),t=n):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i),t===i&&(t=ei,n=Zi(),n!==i?(e.substr(ei,5).toLowerCase()===T?(r=e.substr(ei,5),ei+=5):(r=i,si===0&&pi(N)),r!==i?(s=Zi(),s!==i?(e.charCodeAt(ei)===61?(o=E,ei++):(o=i,si===0&&pi(S)),o!==i?(u=Zi(),u!==i?(a=as(),a!==i?(f=Zi(),f!==i?(ti=t,n=x(r,a),t=n):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i),t===i&&(t=ei,n=Zi(),n!==i?(e.substr(ei,12).toLowerCase()===C?(r=e.substr(ei,12),ei+=12):(r=i,si===0&&pi(k)),r!==i?(s=Zi(),s!==i?(e.charCodeAt(ei)===61?(o=E,ei++):(o=i,si===0&&pi(S)),o!==i?(u=Zi(),u!==i?(a=ss(),a!==i?(f=Zi(),f!==i?(ti=t,n=L(r,a),t=n):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i),t===i&&(t=ei,n=Zi(),n!==i?(e.substr(ei,9).toLowerCase()===A?(r=e.substr(ei,9),ei+=9):(r=i,si===0&&pi(O)),r!==i?(s=Zi(),s!==i?(e.charCodeAt(ei)===61?(o=E,ei++):(o=i,si===0&&pi(S)),o!==i?(u=Zi(),u!==i?(a=Fi(),a!==i?(f=Zi(),f!==i?(ti=t,n=x(r,a),t=n):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)))),t}function bi(){var t,n,r,s,o,u;t=ei,n=ei,r=[],s=ei,o=wi(),o!==i?(e.charCodeAt(ei)===44?(u=c,ei++):(u=i,si===0&&pi(h)),u!==i?(ti=s,o=M(o),s=o):(ei=s,s=i)):(ei=s,s=i);while(s!==i)r.push(s),s=ei,o=wi(),o!==i?(e.charCodeAt(ei)===44?(u=c,ei++):(u=i,si===0&&pi(h)),u!==i?(ti=s,o=M(o),s=o):(ei=s,s=i)):(ei=s,s=i);return r!==i?(s=ei,o=wi(),o!==i?(e.charCodeAt(ei)===59?(u=d,ei++):(u=i,si===0&&pi(v)),u!==i?(ti=s,o=M(o),s=o):(ei=s,s=i)):(ei=s,s=i),s!==i?(r=[r,s],n=r):(ei=n,n=i)):(ei=n,n=i),n!==i&&(ti=t,n=_(n)),t=n,t}function wi(){var t,n,r,s,o,u,a,f,l;return si++,t=ei,n=Zi(),n!==i?(r=Ui(),r!==i?(s=Zi(),s!==i?(o=ei,e.charCodeAt(ei)===58?(u=P,ei++):(u=i,si===0&&pi(H)),u!==i?(a=Zi(),a!==i?(f=ji(),f!==i?(l=Zi(),l!==i?(ti=o,u=B(r,f),o=u):(ei=o,o=i)):(ei=o,o=i)):(ei=o,o=i)):(ei=o,o=i),o===i&&(o=null),o!==i?(ti=t,n=j(r,o),t=n):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i),si--,t===i&&(n=i,si===0&&pi(D)),t}function Ei(){var t,n,r,s,o;t=[],n=ei,r=Si(),r!==i?(s=Zi(),s!==i?(e.charCodeAt(ei)===59?(o=d,ei++):(o=i,si===0&&pi(v)),o!==i?(ti=n,r=F(r),n=r):(ei=n,n=i)):(ei=n,n=i)):(ei=n,n=i);if(n!==i)while(n!==i)t.push(n),n=ei,r=Si(),r!==i?(s=Zi(),s!==i?(e.charCodeAt(ei)===59?(o=d,ei++):(o=i,si===0&&pi(v)),o!==i?(ti=n,r=F(r),n=r):(ei=n,n=i)):(ei=n,n=i)):(ei=n,n=i);else t=i;return t}function Si(){var t,n,r,s,o,u;t=ei,n=ei,r=[],s=ei,o=xi(),o!==i?(e.charCodeAt(ei)===44?(u=c,ei++):(u=i,si===0&&pi(h)),u!==i?(ti=s,o=F(o),s=o):(ei=s,s=i)):(ei=s,s=i);while(s!==i)r.push(s),s=ei,o=xi(),o!==i?(e.charCodeAt(ei)===44?(u=c,ei++):(u=i,si===0&&pi(h)),u!==i?(ti=s,o=F(o),s=o):(ei=s,s=i)):(ei=s,s=i);return r!==i?(s=ei,o=xi(),o!==i&&(ti=s,o=I(o)),s=o,s!==i?(r=[r,s],n=r):(ei=n,n=i)):(ei=n,n=i),n!==i&&(ti=t,n=q(n)),t=n,t}function xi(){var e;return e=Ti(),e===i&&(e=Li()),e}function Ti(){var t,n,r,s,o,u,a;return t=ei,n=ei,r=Ni(),r!==i&&(ti=n,r=R(r)),n=r,n===i&&(n=ei,r=ki(),r!==i&&(ti=n,r=U(r)),n=r,n===i&&(n=ei,r=Ci(),r!==i&&(ti=n,r=z(r)),n=r)),n!==i?(r=ei,e.charCodeAt(ei)===58?(s=P,ei++):(s=i,si===0&&pi(H)),s!==i?(o=Zi(),o!==i?(u=ji(),u!==i?(a=Zi(),a!==i?(ti=r,s=W(n,u),r=s):(ei=r,r=i)):(ei=r,r=i)):(ei=r,r=i)):(ei=r,r=i),r===i&&(r=null),r!==i?(ti=t,n=X(n,r),t=n):(ei=t,t=i)):(ei=t,t=i),t}function Ni(){var e,t,n,r;return e=ei,t=Zi(),t!==i?(n=Ai(),n!==i?(r=Zi(),r!==i?(ti=e,t=V(n),e=t):(ei=e,e=i)):(ei=e,e=i)):(ei=e,e=i),e}function Ci(){var e,t,n,r;return e=ei,t=Zi(),t!==i?(n=Oi(),n!==i?(r=Zi(),r!==i?(ti=e,t=V(n),e=t):(ei=e,e=i)):(ei=e,e=i)):(ei=e,e=i),e}function ki(){var t,n,r,s,o,u,a,f;return t=ei,n=Zi(),n!==i?(r=Ui(),r!==i?(s=Zi(),s!==i?(o=Mi(),o!==i?(u=Zi(),u!==i?(a=Ui(),a!==i?(f=Zi(),f!==i?(ti=t,n=$(r,o,a),t=n):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i),t===i&&(t=ei,n=Zi(),n!==i?(e.charCodeAt(ei)===42?(r=J,ei++):(r=i,si===0&&pi(K)),r!==i?(s=Zi(),s!==i?(o=Pi(),o!==i?(u=Zi(),u!==i?(a=Ui(),a!==i?(f=Zi(),f!==i?(ti=t,n=Q(o,a),t=n):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i),t===i&&(t=ei,n=Zi(),n!==i?(r=Ui(),r!==i?(s=Zi(),s!==i?(o=Di(),o!==i?(u=Zi(),u!==i?(e.charCodeAt(ei)===42?(a=J,ei++):(a=i,si===0&&pi(K)),a!==i?(f=Zi(),f!==i?(ti=t,n=G(r,o),t=n):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i),t===i&&(t=ei,n=Zi(),n!==i?(r=Ui(),r!==i?(s=Zi(),s!==i?(o=_i(),o!==i?(u=Zi(),u!==i?(e.charCodeAt(ei)===42?(a=J,ei++):(a=i,si===0&&pi(K)),a!==i?(f=Zi(),f!==i?(ti=t,n=G(r,o),t=n):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)))),t}function Li(){var t,n,r,s,o,u,a,f,l,c,h,p,d,v,m;return t=ei,n=Zi(),n!==i?(r=Ui(),r!==i?(s=Zi(),s!==i?(o=Bi(),o!==i?(u=Zi(),u!==i?(a=Ui(),a!==i?(f=Zi(),f!==i?(l=ei,e.charCodeAt(ei)===58?(c=P,ei++):(c=i,si===0&&pi(H)),c!==i?(h=Zi(),h!==i?(p=ji(),p!==i?(d=Zi(),d!==i?(ti=l,c=Y(r,o,a,p),l=c):(ei=l,l=i)):(ei=l,l=i)):(ei=l,l=i)):(ei=l,l=i),l===i&&(l=null),l!==i?(e.charCodeAt(ei)===123?(c=Z,ei++):(c=i,si===0&&pi(et)),c!==i?(h=Zi(),h!==i?(p=Ei(),p===i&&(p=null),p!==i?(d=Zi(),d!==i?(e.charCodeAt(ei)===125?(v=tt,ei++):(v=i,si===0&&pi(nt)),v!==i?(m=Zi(),m!==i?(ti=t,n=rt(r,o,a,l,p),t=n):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i),t}function Ai(){var t,n;return si++,e.substr(ei,3)===st?(t=st,ei+=3):(t=i,si===0&&pi(ot)),t===i&&(e.substr(ei,3)===ut?(t=ut,ei+=3):(t=i,si===0&&pi(at))),si--,t===i&&(n=i,si===0&&pi(it)),t}function Oi(){var t,n;return si++,e.substr(ei,3)===lt?(t=lt,ei+=3):(t=i,si===0&&pi(ct)),si--,t===i&&(n=i,si===0&&pi(ft)),t}function Mi(){var e,t;return e=ei,t=_i(),t===i&&(t=Di(),t===i&&(t=Pi(),t===i&&(t=Hi()))),t!==i&&(ti=e,t=ht(t)),e=t,e}function _i(){var t,n;return si++,e.substr(ei,2)===dt?(t=dt,ei+=2):(t=i,si===0&&pi(vt)),t===i&&(e.substr(ei,3)===mt?(t=mt,ei+=3):(t=i,si===0&&pi(gt)),t===i&&(e.substr(ei,2)===yt?(t=yt,ei+=2):(t=i,si===0&&pi(bt)),t===i&&(e.substr(ei,5)===wt?(t=wt,ei+=5):(t=i,si===0&&pi(Et)),t===i&&(e.substr(ei,3)===St?(t=St,ei+=3):(t=i,si===0&&pi(xt)),t===i&&(e.substr(ei,2)===Tt?(t=Tt,ei+=2):(t=i,si===0&&pi(Nt)),t===i&&(e.substr(ei,4)===Ct?(t=Ct,ei+=4):(t=i,si===0&&pi(kt)),t===i&&(e.substr(ei,2)===Lt?(t=Lt,ei+=2):(t=i,si===0&&pi(At)),t===i&&(e.substr(ei,3)===Ot?(t=Ot,ei+=3):(t=i,si===0&&pi(Mt)))))))))),si--,t===i&&(n=i,si===0&&pi(pt)),t}function Di(){var t,n;return si++,e.substr(ei,2)===Dt?(t=Dt,ei+=2):(t=i,si===0&&pi(Pt)),t===i&&(e.substr(ei,3)===Ht?(t=Ht,ei+=3):(t=i,si===0&&pi(Bt)),t===i&&(e.substr(ei,2)===jt?(t=jt,ei+=2):(t=i,si===0&&pi(Ft)),t===i&&(e.substr(ei,2)===It?(t=It,ei+=2):(t=i,si===0&&pi(qt)),t===i&&(e.substr(ei,2)===Rt?(t=Rt,ei+=2):(t=i,si===0&&pi(Ut)),t===i&&(e.substr(ei,2).toLowerCase()===zt?(t=e.substr(ei,2),ei+=2):(t=i,si===0&&pi(Wt))))))),si--,t===i&&(n=i,si===0&&pi(_t)),t}function Pi(){var t,n;return si++,e.substr(ei,2)===Vt?(t=Vt,ei+=2):(t=i,si===0&&pi($t)),t===i&&(e.substr(ei,3)===Jt?(t=Jt,ei+=3):(t=i,si===0&&pi(Kt)),t===i&&(e.substr(ei,2)===Qt?(t=Qt,ei+=2):(t=i,si===0&&pi(Gt)),t===i&&(e.substr(ei,2)===Yt?(t=Yt,ei+=2):(t=i,si===0&&pi(Zt)),t===i&&(e.substr(ei,2)===en?(t=en,ei+=2):(t=i,si===0&&pi(tn)),t===i&&(e.substr(ei,2).toLowerCase()===nn?(t=e.substr(ei,2),ei+=2):(t=i,si===0&&pi(rn))))))),si--,t===i&&(n=i,si===0&&pi(Xt)),t}function Hi(){var t,n;return si++,e.substr(ei,4).toLowerCase()===on?(t=e.substr(ei,4),ei+=4):(t=i,si===0&&pi(un)),t===i&&(e.substr(ei,4).toLowerCase()===an?(t=e.substr(ei,4),ei+=4):(t=i,si===0&&pi(fn)),t===i&&(e.substr(ei,4).toLowerCase()===ln?(t=e.substr(ei,4),ei+=4):(t=i,si===0&&pi(cn)),t===i&&(e.substr(ei,3).toLowerCase()===hn?(t=e.substr(ei,3),ei+=3):(t=i,si===0&&pi(pn))))),si--,t===i&&(n=i,si===0&&pi(sn)),t}function Bi(){var t,n;return si++,t=ei,e.substr(ei,3).toLowerCase()===vn?(n=e.substr(ei,3),ei+=3):(n=i,si===0&&pi(mn)),n===i&&(e.substr(ei,4).toLowerCase()===gn?(n=e.substr(ei,4),ei+=4):(n=i,si===0&&pi(yn)),n===i&&(e.substr(ei,3).toLowerCase()===bn?(n=e.substr(ei,3),ei+=3):(n=i,si===0&&pi(wn)),n===i&&(e.substr(ei,5).toLowerCase()===En?(n=e.substr(ei,5),ei+=5):(n=i,si===0&&pi(Sn)),n===i&&(e.substr(ei,3).toLowerCase()===xn?(n=e.substr(ei,3),ei+=3):(n=i,si===0&&pi(Tn)),n===i&&(e.substr(ei,3).toLowerCase()===Nn?(n=e.substr(ei,3),ei+=3):(n=i,si===0&&pi(Cn)),n===i&&(e.substr(ei,6).toLowerCase()===kn?(n=e.substr(ei,6),ei+=6):(n=i,si===0&&pi(Ln)),n===i&&(e.substr(ei,3).toLowerCase()===An?(n=e.substr(ei,3),ei+=3):(n=i,si===0&&pi(On)),n===i&&(e.substr(ei,8).toLowerCase()===Mn?(n=e.substr(ei,8),ei+=8):(n=i,si===0&&pi(_n)),n===i&&(e.substr(ei,6).toLowerCase()===Dn?(n=e.substr(ei,6),ei+=6):(n=i,si===0&&pi(Pn)),n===i&&(e.substr(ei,8).toLowerCase()===Hn?(n=e.substr(ei,8),ei+=8):(n=i,si===0&&pi(Bn)),n===i&&(e.substr(ei,6).toLowerCase()===jn?(n=e.substr(ei,6),ei+=6):(n=i,si===0&&pi(Fn)),n===i&&(e.substr(ei,4).toLowerCase()===In?(n=e.substr(ei,4),ei+=4):(n=i,si===0&&pi(qn)),n===i&&(e.substr(ei,3).toLowerCase()===Rn?(n=e.substr(ei,3),ei+=3):(n=i,si===0&&pi(Un)),n===i&&(e.substr(ei,3).toLowerCase()===zn?(n=e.substr(ei,3),ei+=3):(n=i,si===0&&pi(Wn)))))))))))))))),n!==i&&(ti=t,n=Xn(n)),t=n,si--,t===i&&(n=i,si===0&&pi(dn)),t}function ji(){var e;return e=Fi(),e===i&&(e=qi()),e}function Fi(){var t,n,r,s;return si++,t=ei,e.charCodeAt(ei)===34?(n=$n,ei++):(n=i,si===0&&pi(Jn)),n!==i?(r=Ii(),r!==i?(e.charCodeAt(ei)===34?(s=$n,ei++):(s=i,si===0&&pi(Jn)),s!==i?(ti=t,n=Kn(r),t=n):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i),si--,t===i&&(n=i,si===0&&pi(Vn)),t}function Ii(){var t,n,r,s;t=[],n=ei,r=ei,si++,e.charCodeAt(ei)===34?(s=$n,ei++):(s=i,si===0&&pi(Jn)),si--,s===i?r=void 0:(ei=r,r=i),r!==i?(e.substr(ei,2)===Qn?(s=Qn,ei+=2):(s=i,si===0&&pi(Gn)),s===i&&(e.length>ei?(s=e.charAt(ei),ei++):(s=i,si===0&&pi(Yn))),s!==i?(ti=n,r=Zn(s),n=r):(ei=n,n=i)):(ei=n,n=i);while(n!==i)t.push(n),n=ei,r=ei,si++,e.charCodeAt(ei)===34?(s=$n,ei++):(s=i,si===0&&pi(Jn)),si--,s===i?r=void 0:(ei=r,r=i),r!==i?(e.substr(ei,2)===Qn?(s=Qn,ei+=2):(s=i,si===0&&pi(Gn)),s===i&&(e.length>ei?(s=e.charAt(ei),ei++):(s=i,si===0&&pi(Yn))),s!==i?(ti=n,r=Zn(s),n=r):(ei=n,n=i)):(ei=n,n=i);return t}function qi(){var e,t;return e=ei,t=Ri(),t!==i&&(ti=e,t=er(t)),e=t,e}function Ri(){var t,n,r,s;t=[],n=ei,r=ei,si++,e.charCodeAt(ei)===44?(s=c,ei++):(s=i,si===0&&pi(h)),s===i&&(e.charCodeAt(ei)===59?(s=d,ei++):(s=i,si===0&&pi(v)),s===i&&(e.charCodeAt(ei)===123?(s=Z,ei++):(s=i,si===0&&pi(et)))),si--,s===i?r=void 0:(ei=r,r=i),r!==i?(e.length>ei?(s=e.charAt(ei),ei++):(s=i,si===0&&pi(Yn)),s!==i?(ti=n,r=Zn(s),n=r):(ei=n,n=i)):(ei=n,n=i);while(n!==i)t.push(n),n=ei,r=ei,si++,e.charCodeAt(ei)===44?(s=c,ei++):(s=i,si===0&&pi(h)),s===i&&(e.charCodeAt(ei)===59?(s=d,ei++):(s=i,si===0&&pi(v)),s===i&&(e.charCodeAt(ei)===123?(s=Z,ei++):(s=i,si===0&&pi(et)))),si--,s===i?r=void 0:(ei=r,r=i),r!==i?(e.length>ei?(s=e.charAt(ei),ei++):(s=i,si===0&&pi(Yn)),s!==i?(ti=n,r=Zn(s),n=r):(ei=n,n=i)):(ei=n,n=i);return t}function Ui(){var t,n,r;si++,t=ei,n=[],nr.test(e.charAt(ei))?(r=e.charAt(ei),ei++):(r=i,si===0&&pi(rr));if(r!==i)while(r!==i)n.push(r),nr.test(e.charAt(ei))?(r=e.charAt(ei),ei++):(r=i,si===0&&pi(rr));else n=i;return n!==i&&(ti=t,n=ir(n)),t=n,t===i&&(t=Fi()),si--,t===i&&(n=i,si===0&&pi(tr)),t}function zi(){var t,n;return si++,t=ei,or.test(e.charAt(ei))?(n=e.charAt(ei),ei++):(n=i,si===0&&pi(ur)),n!==i&&(ti=t,n=Zn(n)),t=n,si--,t===i&&(n=i,si===0&&pi(sr)),t}function Wi(){var t,n;return si++,t=ei,fr.test(e.charAt(ei))?(n=e.charAt(ei),ei++):(n=i,si===0&&pi(lr)),n!==i&&(ti=t,n=Zn(n)),t=n,si--,t===i&&(n=i,si===0&&pi(ar)),t}function Xi(){var t;return e.substr(ei,2)===cr?(t=cr,ei+=2):(t=i,si===0&&pi(hr)),t}function Vi(){var t;return e.substr(ei,2)===pr?(t=pr,ei+=2):(t=i,si===0&&pi(dr)),t}function $i(){var t,n,r;return t=ei,n=ei,si++,e.substr(ei,2)===pr?(r=pr,ei+=2):(r=i,si===0&&pi(dr)),si--,r===i?n=void 0:(ei=n,n=i),n!==i?(e.length>ei?(r=e.charAt(ei),ei++):(r=i,si===0&&pi(Yn)),r!==i?(ti=t,n=Zn(r),t=n):(ei=t,t=i)):(ei=t,t=i),t}function Ji(){var e,t,n,r;e=ei,t=Xi();if(t!==i){n=[],r=$i();while(r!==i)n.push(r),r=$i();n!==i?(r=Vi(),r!==i?(ti=e,t=vr(t,n,r),e=t):(ei=e,e=i)):(ei=e,e=i)}else ei=e,e=i;return e}function Ki(){var t;return e.substr(ei,2)===mr?(t=mr,ei+=2):(t=i,si===0&&pi(gr)),t===i&&(e.charCodeAt(ei)===35?(t=yr,ei++):(t=i,si===0&&pi(br))),t}function Qi(){var t;return wr.test(e.charAt(ei))?(t=e.charAt(ei),ei++):(t=i,si===0&&pi(Er)),t}function Gi(){var e,t,n,r;e=ei,t=Ki();if(t!==i){n=[],r=Qi();while(r!==i)n.push(r),r=Qi();n!==i?(ti=e,t=Sr(t,n),e=t):(ei=e,e=i)}else ei=e,e=i;return e}function Yi(){var e,t;return si++,e=Gi(),e===i&&(e=Ji()),si--,e===i&&(t=i,si===0&&pi(xr)),e}function Zi(){var e,t;e=[],t=zi(),t===i&&(t=Wi(),t===i&&(t=Yi()));while(t!==i)e.push(t),t=zi(),t===i&&(t=Wi(),t===i&&(t=Yi()));return e}function es(){var e,t;return si++,e=ei,t=ts(),t!==i&&(ti=e,t=Nr(t)),e=t,e===i&&(e=ei,t=ns(),t!==i&&(ti=e,t=Cr(t)),e=t),si--,e===i&&(t=i,si===0&&pi(Tr)),e}function ts(){var t,n,r,s;return t=ei,e.charCodeAt(ei)===34?(n=$n,ei++):(n=i,si===0&&pi(Jn)),n!==i?(r=ns(),r!==i?(e.charCodeAt(ei)===34?(s=$n,ei++):(s=i,si===0&&pi(Jn)),s!==i?(ti=t,n=kr(r),t=n):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i),t}function ns(){var e;return e=is(),e===i&&(e=rs()),e}function rs(){var t,n,r;t=ei,n=[],Lr.test(e.charAt(ei))?(r=e.charAt(ei),ei++):(r=i,si===0&&pi(Ar));if(r!==i)while(r!==i)n.push(r),Lr.test(e.charAt(ei))?(r=e.charAt(ei),ei++):(r=i,si===0&&pi(Ar));else n=i;return n!==i&&(ti=t,n=Or(n)),t=n,t}function is(){var t,n,r,s,o;return t=ei,n=ei,r=rs(),r!==i?(e.charCodeAt(ei)===46?(s=Mr,ei++):(s=i,si===0&&pi(_r)),s!==i?(o=rs(),o!==i?(r=[r,s,o],n=r):(ei=n,n=i)):(ei=n,n=i)):(ei=n,n=i),n!==i&&(ti=t,n=Dr(n)),t=n,t}function ss(){var e,t;return si++,e=ei,t=os(),t!==i&&(ti=e,t=Hr(t)),e=t,e===i&&(e=ei,t=us(),t!==i&&(ti=e,t=Br(t)),e=t),si--,e===i&&(t=i,si===0&&pi(Pr)),e}function os(){var t,n,r,s;return t=ei,e.charCodeAt(ei)===34?(n=$n,ei++):(n=i,si===0&&pi(Jn)),n!==i?(r=us(),r!==i?(e.charCodeAt(ei)===34?(s=$n,ei++):(s=i,si===0&&pi(Jn)),s!==i?(ti=t,n=Nr(r),t=n):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i),t}function us(){var t;return e.substr(ei,4).toLowerCase()===jr?(t=e.substr(ei,4),ei+=4):(t=i,si===0&&pi(Fr)),t===i&&(e.substr(ei,5).toLowerCase()===Ir?(t=e.substr(ei,5),ei+=5):(t=i,si===0&&pi(qr)),t===i&&(e.substr(ei,2).toLowerCase()===Rr?(t=e.substr(ei,2),ei+=2):(t=i,si===0&&pi(Ur)),t===i&&(e.substr(ei,3).toLowerCase()===zr?(t=e.substr(ei,3),ei+=3):(t=i,si===0&&pi(Wr)),t===i&&(e.charCodeAt(ei)===48?(t=Xr,ei++):(t=i,si===0&&pi(Vr)),t===i&&(e.charCodeAt(ei)===49?(t=$r,ei++):(t=i,si===0&&pi(Jr))))))),t}function as(){var e,t;return si++,e=fs(),e===i&&(e=ls()),si--,e===i&&(t=i,si===0&&pi(Kr)),e}function fs(){var t,n,r,s;return t=ei,e.charCodeAt(ei)===34?(n=$n,ei++):(n=i,si===0&&pi(Jn)),n!==i?(r=ls(),r!==i?(e.charCodeAt(ei)===34?(s=$n,ei++):(s=i,si===0&&pi(Jn)),s!==i?(ti=t,n=Nr(r),t=n):(ei=t,t=i)):(ei=t,t=i)):(ei=t,t=i),t}function ls(){var t,n;return t=ei,n=ns(),n!==i&&(ti=t,n=Qr(n)),t=n,t===i&&(t=ei,e.substr(ei,4).toLowerCase()===Gr?(n=e.substr(ei,4),ei+=4):(n=i,si===0&&pi(Yr)),n!==i&&(ti=t,n=Zr(n)),t=n),t}function cs(e,t){t&&Object.getOwnPropertyNames(t).forEach(function(n){e[n]=t[n]})}function hs(e,t){return e=e?e:{},cs(e,t),e}function ps(e){var t={};return e[0].forEach(function(e){t=hs(t,e)}),hs(t,e[1])}function ds(e){return["true","on","1"].indexOf(e.toLowerCase())>-1}function vs(e,t){var n={};return n[e.toLowerCase()]=t,n}function ms(e,t,n){return t===undefined||t==="*"?!0:e.entities.some(function(e){return e.name===t})?!0:n[t]===!0}function gs(e){var t={};return t.name=e,t}function ys(e,t,n){return e||(e={},e.entities=[]),n||(n={}),t&&t.arcs&&t.arcs.forEach(function(t){t.forEach(function(t){ms(e,t.from,n)||(e.entities[e.entities.length]=gs(t.from)),t.arcs&&(n[t.to]=!0,hs(e,ys(e,t,n)),delete n[t.to]),ms(e,t.to,n)||(e.entities[e.entities.length]=gs(t.to))})}),e}function bs(e){return e&&e.options?!!e.options.watermark||!!e.options.width&&e.options.width==="auto":!1}function ws(e){return e&&e.arcs?e.arcs.some(function(e){return e.some(function(e){return["alt","else","opt","break","par","seq","strict","neg","critical","ignore","consider","assert","loop","ref","exc"].indexOf(e.kind)>-1})}):!1}function Es(e,t){var n=bs(e),r=ws(t);return{extendedOptions:n,extendedArcTypes:r,extendedFeatures:n||r}}var n=arguments.length>1?arguments[1]:{},r=this,i={},s={program:vi},o=vi,u=function(e,t){t[1]=ys(t[1],t[2]);var n=hs(t[0],hs(t[1],t[2]));return n=hs({meta:Es(t[0],t[2])},n),e.length>0&&(n=hs({precomment:e},n)),n},a=function(e){return{options:e}},f=function(e){return{entities:e}},l=function(e){return{arcs:e}},c=",",h={type:"literal",value:",",description:'","'},p=function(e){return e},d=";",v={type:"literal",value:";",description:'";"'},m=function(e){return ps(e)},g="hscale",y={type:"literal",value:"hscale",description:'"hscale"'},b="arcgradient",w={type:"literal",value:"arcgradient",description:'"arcgradient"'},E="=",S={type:"literal",value:"=",description:'"="'},x=function(e,t){return vs(e,t)},T="width",N={type:"literal",value:"width",description:'"width"'},C="wordwraparcs",k={type:"literal",value:"wordwraparcs",description:'"wordwraparcs"'},L=function(e,t){var n={};return n[e.toLowerCase()]=ds(t),n},A="watermark",O={type:"literal",value:"watermark",description:'"watermark"'},M=function(e){return e},_=function(e){return e[0].push(e[1]),e[0]},D={type:"other",description:"entity"},P=":",H={type:"literal",value:":",description:'":"'},B=function(e,t){return t},j=function(e,t){var n={};return n.name=e,!t||(n.label=t),n},F=function(e){return e},I=function(e){return[e]},q=function(e){return e[0].push(e[1][0]),e[0]},R=function(e){return e},U=function(e){return e},z=function(e){return e},W=function(e,t){return t},X=function(e,t){return t&&(e.label=t),e},V=function(e){return{kind:e}},$=function(e,t,n){return{kind:t,from:e,to:n}},J="*",K={type:"literal",value:"*",description:'"*"'},Q=function(e,t){return{kind:e,from:"*",to:t}},G=function(e,t){return{kind:t,from:e,to:"*"}},Y=function(e,t,n,r){return r},Z="{",et={type:"literal",value:"{",description:'"{"'},tt="}",nt={type:"literal",value:"}",description:'"}"'},rt=function(e,t,n,r,i){var s={kind:t,from:e,to:n,arcs:i};return r&&(s.label=r),s},it={type:"other",description:"empty row"},st="|||",ot={type:"literal",value:"|||",description:'"|||"'},ut="...",at={type:"literal",value:"...",description:'"..."'},ft={type:"other",description:"---"},lt="---",ct={type:"literal",value:"---",description:'"---"'},ht=function(e){return e.toLowerCase()},pt={type:"other",description:"bi-directional arrow"},dt="--",vt={type:"literal",value:"--",description:'"--"'},mt="<->",gt={type:"literal",value:"<->",description:'"<->"'},yt="==",bt={type:"literal",value:"==",description:'"=="'},wt="<<=>>",Et={type:"literal",value:"<<=>>",description:'"<<=>>"'},St="<=>",xt={type:"literal",value:"<=>",description:'"<=>"'},Tt="..",Nt={type:"literal",value:"..",description:'".."'},Ct="<<>>",kt={type:"literal",value:"<<>>",description:'"<<>>"'},Lt="::",At={type:"literal",value:"::",description:'"::"'},Ot="<:>",Mt={type:"literal",value:"<:>",description:'"<:>"'},_t={type:"other",description:"left to right arrow"},Dt="->",Pt={type:"literal",value:"->",description:'"->"'},Ht="=>>",Bt={type:"literal",value:"=>>",description:'"=>>"'},jt="=>",Ft={type:"literal",value:"=>",description:'"=>"'},It=">>",qt={type:"literal",value:">>",description:'">>"'},Rt=":>",Ut={type:"literal",value:":>",description:'":>"'},zt="-x",Wt={type:"literal",value:"-x",description:'"-x"'},Xt={type:"other",description:"right to left arrow"},Vt="<-",$t={type:"literal",value:"<-",description:'"<-"'},Jt="<<=",Kt={type:"literal",value:"<<=",description:'"<<="'},Qt="<=",Gt={type:"literal",value:"<=",description:'"<="'},Yt="<<",Zt={type:"literal",value:"<<",description:'"<<"'},en="<:",tn={type:"literal",value:"<:",description:'"<:"'},nn="x-",rn={type:"literal",value:"x-",description:'"x-"'},sn={type:"other",description:"box"},on="note",un={type:"literal",value:"note",description:'"note"'},an="abox",fn={type:"literal",value:"abox",description:'"abox"'},ln="rbox",cn={type:"literal",value:"rbox",description:'"rbox"'},hn="box",pn={type:"literal",value:"box",description:'"box"'},dn={type:"other",description:"inline expression"},vn="alt",mn={type:"literal",value:"alt",description:'"alt"'},gn="else",yn={type:"literal",value:"else",description:'"else"'},bn="opt",wn={type:"literal",value:"opt",description:'"opt"'},En="break",Sn={type:"literal",value:"break",description:'"break"'},xn="par",Tn={type:"literal",value:"par",description:'"par"'},Nn="seq",Cn={type:"literal",value:"seq",description:'"seq"'},kn="strict",Ln={type:"literal",value:"strict",description:'"strict"'},An="neg",On={type:"literal",value:"neg",description:'"neg"'},Mn="critical",_n={type:"literal",value:"critical",description:'"critical"'},Dn="ignore",Pn={type:"literal",value:"ignore",description:'"ignore"'},Hn="consider",Bn={type:"literal",value:"consider",description:'"consider"'},jn="assert",Fn={type:"literal",value:"assert",description:'"assert"'},In="loop",qn={type:"literal",value:"loop",description:'"loop"'},Rn="ref",Un={type:"literal",value:"ref",description:'"ref"'},zn="exc",Wn={type:"literal",value:"exc",description:'"exc"'},Xn=function(e){return e.toLowerCase()},Vn={type:"other",description:"double quoted string"},$n='"',Jn={type:"literal",value:'"',description:'"\\""'},Kn=function(e){return e.join("")},Qn='\\"',Gn={type:"literal",value:'\\"',description:'"\\\\\\""'},Yn={type:"any",description:"any character"},Zn=function(e){return e},er=function(e){return e.join("").trim()},tr={type:"other",description:"identifier"},nr=/^[^;, "\t\n\r=\-><:{*]/,rr={type:"class",value:'[^;, \\"\\t\\n\\r=\\-><:\\{\\*]',description:'[^;, \\"\\t\\n\\r=\\-><:\\{\\*]'},ir=function(e){return e.join("")},sr={type:"other",description:"whitespace"},or=/^[ \t]/,ur={type:"class",value:"[ \\t]",description:"[ \\t]"},ar={type:"other",description:"lineend"},fr=/^[\r\n]/,lr={type:"class",value:"[\\r\\n]",description:"[\\r\\n]"},cr="/*",hr={type:"literal",value:"/*",description:'"/*"'},pr="*/",dr={type:"literal",value:"*/",description:'"*/"'},vr=function(e,t,n){return e+t.join("")+n},mr="//",gr={type:"literal",value:"//",description:'"//"'},yr="#",br={type:"literal",value:"#",description:'"#"'},wr=/^[^\r\n]/,Er={type:"class",value:"[^\\r\\n]",description:"[^\\r\\n]"},Sr=function(e,t){return e+t.join("")},xr={type:"other",description:"comment"},Tr={type:"other",description:"number"},Nr=function(e){return e},Cr=function(e){return e.toString()},kr=function(e){return e.toString()},Lr=/^[0-9]/,Ar={type:"class",value:"[0-9]",description:"[0-9]"},Or=function(e){return parseInt(e.join(""),10)},Mr=".",_r={type:"literal",value:".",description:'"."'},Dr=function(e){return parseFloat(e.join(""))},Pr={type:"other",description:"boolean"},Hr=function(e){return e},Br=function(e){return e.toString()},jr="true",Fr={type:"literal",value:"true",description:'"true"'},Ir="false",qr={type:"literal",value:"false",description:'"false"'},Rr="on",Ur={type:"literal",value:"on",description:'"on"'},zr="off",Wr={type:"literal",value:"off",description:'"off"'},Xr="0",Vr={type:"literal",value:"0",description:'"0"'},$r="1",Jr={type:"literal",value:"1",description:'"1"'},Kr={type:"other",description:"size"},Qr=function(e){return e.toString()},Gr="auto",Yr={type:"literal",value:"auto",description:'"auto"'},Zr=function(e){return e.toLowerCase()},ei=0,ti=0,ni=[{line:1,column:1,seenCR:!1}],ri=0,ii=[],si=0,oi;if("startRule"in n){if(!(n.startRule in s))throw new Error("Can't start parsing from rule \""+n.startRule+'".');o=s[n.startRule]}oi=o();if(oi!==i&&ei===e.length)return oi;throw oi!==i&&ei<e.length&&pi({type:"end",description:"end of input"}),di(null,ii,ri<e.length?e.charAt(ri):null,ri<e.length?hi(ri,ri+1):hi(ri,ri))}return e(t,Error),{SyntaxError:t,parse:n}}),n("lib/mscgenjs-core/render/graphics/constants",[],function(){"use strict";return{SVGNS:"http://www.w3.org/2000/svg",XLINKNS:"http://www.w3.org/1999/xlink",LINE_WIDTH:2,FONT_SIZE:12}}),n("lib/mscgenjs-core/render/graphics/svgelementfactory",["./constants"],function(e){"use strict";function r(e){return t.createTextNode(e)}function i(n,r,i,s){var o=t.createElementNS(e.SVGNS,"path");return o.setAttribute("d",n),r&&o.setAttribute("class",r),u(o,i,s),o}function s(n,r){var i=t.createElementNS(e.SVGNS,"polygon");return i.setAttribute("points",n),r&&i.setAttribute("class",r),i}function o(n,r,i,s,o,a){var f=t.createElementNS(e.SVGNS,"rect");return f.setAttribute("width",n.width),f.setAttribute("height",n.height),n.x&&f.setAttribute("x",n.x),n.y&&f.setAttribute("y",n.y),o&&f.setAttribute("rx",o),a&&f.setAttribute("ry",a),r&&f.setAttribute("class",r),u(f,i,s),f}function u(e,t,n){if(!!t||!!n){var r="";n&&(r+="fill:"+n+";"),t&&(r+="stroke:"+t+";"),e.setAttribute("style",r)}}function a(e,t,n,r){var s=3;return i("M"+e.x+","+e.y+"l"+s+", -"+e.height/2+"l"+(e.width-2*s)+",0"+"l"+s+","+e.height/2+"l-"+s+","+e.height/2+"l-"+(e.width-2*s)+",0 "+"l-"+s+",-"+e.height/2,t,n,r)}function f(t,n,r,s){var o=Math.max(9,Math.min(4.5*e.LINE_WIDTH,t.height/2)),u=o.toString(10);return i("M"+t.x+","+t.y+"l"+(t.width-o)+",0 "+"l0,"+u+" l"+u+",0 m-"+u+",-"+u+" l"+u+","+u+" "+"l0,"+(t.height-o)+" "+"l-"+t.width+",0 "+"l0,-"+(t.height+e.LINE_WIDTH/2)+" ",n,r,s)}function l(e,t,n,r,s){var o=s?s:7;return i("M"+e.x+","+e.y+" l"+e.width+",0 "+" l0,"+(e.height-o)+" l-"+o.toString(10)+","+o.toString(10)+" l-"+(e.width-o)+",0 ",t,n,r)}function c(n,r){var i=t.createElementNS(e.SVGNS,"a");return i.setAttributeNS(e.XLINKNS,"xlink:href",n),i.setAttributeNS(e.XLINKNS,"xlink:title",n),i.setAttributeNS(e.XLINKNS,"xlink:show","new"),i.appendChild(r),i}function h(n,r){var i=t.createElementNS(e.SVGNS,"tspan"),s=t.createTextNode(n);return i.appendChild(s),r?c(r,i):i}function p(r,i,s,o,u,a,f){var l=t.createElementNS(e.SVGNS,"text");if(!!r&&r!==""){l.setAttribute("x",i.toString()),l.setAttribute("y",s.toString()),o&&l.setAttribute("class",o),l.appendChild(h(r,u));if(a){var c=h(" ["+a+"]",f);c.setAttribute("style",n),l.appendChild(c)}}return l}function d(e,t){var n=p(e,t.width/2,t.height/2,"watermark"),r=0-Math.atan(t.height/t.width)*360/(2*Math.PI);return n.setAttribute("transform","rotate("+r.toString()+" "+(t.width/2).toString()+" "+(t.height/2).toString()+")"),n}function v(n,r){var i=t.createElementNS(e.SVGNS,"line");return i.setAttribute("x1",n.xFrom.toString()),i.setAttribute("y1",n.yFrom.toString()),i.setAttribute("x2",n.xTo.toString()),i.setAttribute("y2",n.yTo.toString()),r&&i.setAttribute("class",r),i}function m(e){var t=-1;return e.xTo>e.xFrom&&(t=1),{dx:t,dy:t*(e.yTo-e.yFrom)/(e.xTo-e.xFrom)}}function g(t,n){var r=0;return n!=="nodi"&&(r=t.xTo>t.xFrom?-7.5*e.LINE_WIDTH:7.5*e.LINE_WIDTH),r}function y(t,n){var r=0;return n!=="nodi"&&(r=n==="bidi"?t.xTo>t.xFrom?7.5*e.LINE_WIDTH:-7.5*e.LINE_WIDTH:0),r}function b(t,n){var r=e.LINE_WIDTH,s=m(t),o=g(t,n),u=y(t,n),a=(t.xTo-t.xFrom+o-u).toString(),f=(t.yTo-t.yFrom).toString(),l="l"+s.dx.toString()+","+s.dy.toString(),c=" l"+a+","+f;return i("M"+t.xFrom.toString()+","+(t.yFrom-7.5*e.LINE_WIDTH*s.dy).toString()+l+"M"+(t.xFrom+u).toString()+","+(t.yFrom-r).toString()+c+"M"+(t.xFrom+u).toString()+","+(t.yFrom+r).toString()+c+"M"+(t.xTo-s.dx).toString()+","+(t.yTo+7.5*e.LINE_WIDTH*s.dy).toString()+l,n)}function w(e,t,n){return n?b(e,t):v(e,t)}function E(t,n,r,s){var o=s?t.x+7.5*e.LINE_WIDTH:t.x;return i("M"+t.x.toString()+", -"+t.y.toString()+" C"+(t.x+r).toString()+","+(t.y-7.5*e.LINE_WIDTH).toString()+" "+(t.x+r).toString()+","+(n+0).toString()+" "+o.toString()+","+n.toString())}function S(n){var r=t.createElementNS(e.SVGNS,"g");return!n||r.setAttribute("id",n),r}function x(n,r,i){var s=t.createElementNS(e.SVGNS,"use");return s.setAttribute("x",n.toString()),s.setAttribute("y",r.toString()),s.setAttributeNS(e.XLINKNS,"xlink:href","#"+i),s}function T(n,r,i,s){var o=s?s:"0 0 10 10",u=t.createElementNS(e.SVGNS,"marker");return u.setAttribute("orient",i),u.setAttribute("id",n),u.setAttribute("class",r),u.setAttribute("viewBox",o),u.setAttribute("refX","9"),u.setAttribute("refY","3"),u.setAttribute("markerUnits","strokeWidth"),u.setAttribute("markerWidth","10"),u.setAttribute("markerHeight","10"),u}function N(e,t,n){var r=T(e,"arrow-marker","auto"),s=i(t,"arrow-style");return s.setAttribute("style","stroke-dasharray:100,1; stroke : "+n||"black"),r.appendChild(s),r}function C(e,t,n){var r=T(e,"arrow-marker","auto"),i=s(t,"arrow-style");return i.setAttribute("stroke",n||"black"),i.setAttribute("fill",n||"black"),r.appendChild(i),r}var t,n="vertical-align : text-top;";return n+="font-size: 0.7em; text-anchor: start;",{init:function(e){t=e},createTextNode:r,createRect:o,createABox:a,createNote:f,createEdgeRemark:l,createText:p,createDiagonalText:d,createLine:w,createUTurn:E,createGroup:S,createUse:x,createMarkerPath:N,createMarkerPolygon:C}}),n("lib/mscgenjs-core/render/graphics/idmanager",[],function(){"use strict";var e="mscgen_js-svg-",t=e;return{setPrefix:function(n){t=e+n},get:function(e){return e?t+e:t}}}),function(){function et(e,t){return e.set(t[0],t[1]),e}function tt(e,t){return e.add(t),e}function nt(e,t,n){var r=n.length;switch(r){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function rt(e,t){var n=-1,r=e.length;while(++n<r)if(t(e[n],n,e)===!1)break;return e}function it(e,t){var n=-1,r=t.length,i=e.length;while(++n<r)e[i+n]=t[n];return e}function st(e,t,n,r){var i=-1,s=e.length;r&&s&&(n=e[++i]);while(++i<s)n=t(n,e[i],i,e);return n}function ot(e,t){var n=-1,r=Array(e);while(++n<e)r[n]=t(n);return r}function ut(e){return e&&e.Object===Object?e:null}function at(e){var t=!1;if(e!=null&&typeof e.toString!="function")try{t=!!(e+"")}catch(n){}return t}function ft(e,t){return e=typeof e=="number"||U.test(e)?+e:-1,t=t==null?u:t,e>-1&&e%1==0&&e<t}function lt(e){var t,n=[];while(!(t=e.next()).done)n.push(t.value);return n}function ct(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}function ht(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function Rt(){}function Ut(){}function zt(e,t){return Xt(e,t)&&delete e[t]}function Wt(t,n){if(Pt){var r=t[n];return r===s?e:r}return mt.call(t,n)?t[n]:e}function Xt(t,n){return Pt?t[n]!==e:mt.call(t,n)}function Vt(t,n,r){t[n]=Pt&&r===e?s:r}function $t(e){var t=-1,n=e?e.length:0;this.clear();while(++t<n){var r=e[t];this.set(r[0],r[1])}}function Jt(){this.__data__={hash:new Ut,map:Mt?new Mt:[],string:new Ut}}function Kt(e){var t=this.__data__;return Xn(e)?zt(typeof e=="string"?t.string:t.hash,e):Mt?t.map["delete"](e):on(t.map,e)}function Qt(e){var t=this.__data__;return Xn(e)?Wt(typeof e=="string"?t.string:t.hash,e):Mt?t.map.get(e):un(t.map,e)}function Gt(e){var t=this.__data__;return Xn(e)?Xt(typeof e=="string"?t.string:t.hash,e):Mt?t.map.has(e):an(t.map,e)}function Yt(e,t){var n=this.__data__;return Xn(e)?Vt(typeof e=="string"?n.string:n.hash,e,t):Mt?n.map.set(e,t):ln(n.map,e,t),this}function Zt(e){var t=-1,n=e?e.length:0;this.clear();while(++t<n){var r=e[t];this.set(r[0],r[1])}}function en(){this.__data__={array:[],map:null}}function tn(e){var t=this.__data__,n=t.array;return n?on(n,e):t.map["delete"](e)}function nn(e){var t=this.__data__,n=t.array;return n?un(n,e):t.map.get(e)}function rn(e){var t=this.__data__,n=t.array;return n?an(n,e):t.map.has(e)}function sn(e,t){var n=this.__data__,i=n.array;i&&(i.length<r-1?ln(i,e,t):(n.array=null,n.map=new $t(i)));var s=n.map;return s&&s.set(e,t),this}function on(e,t){var n=fn(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():Lt.call(e,n,1),!0}function un(t,n){var r=fn(t,n);return r<0?e:t[r][1]}function an(e,t){return fn(e,t)>-1}function fn(e,t){var n=e.length;while(n--)if(Gn(e[n][0],t))return n;return-1}function ln(e,t,n){var r=fn(e,t);r<0?e.push([t,n]):e[r][1]=n}function cn(t,n,r,i){return t===e||Gn(t,dt[r])&&!mt.call(i,r)?n:t}function hn(t,n,r){var i=t[n];if(!mt.call(t,n)||!Gn(i,r)||r===e&&!(n in t))t[n]=r}function pn(e,t){return e&&Mn(t,pr(t),e)}function dn(t,n,r,i,s,o,u){var a;i&&(a=o?i(t,s,o,u):i(t));if(a!==e)return a;if(!sr(t))return t;var f=Zn(t);if(f){a=qn(t);if(!n)return On(t,a)}else{var c=In(t),h=c==v||c==m;if(nr(t))return xn(t,n);if(c==b||c==l||h&&!o){if(at(t))return o?t:{};a=Rn(h?{}:t);if(!n)return a=pn(a,t),r?Dn(t,a):a}else{if(!z[c])return o?t:{};a=Un(t,c,n)}}u||(u=new Zt);var p=u.get(t);return p?p:(u.set(t,a),(f?rt:yn)(t,function(e,s){hn(a,s,dn(e,n,r,i,s,t,u))}),r&&!f?Dn(t,a):a)}function vn(e){return sr(e)?Ct(e):{}}function mn(e,t,n,r){r||(r=[]);var i=-1,s=e.length;while(++i<s){var o=e[i];t>0&&tr(o)&&(n||Zn(o)||Yn(o))?t>1?mn(o,t-1,n,r):it(r,o):n||(r[r.length]=o)}return r}function yn(e,t){return e&&gn(e,t,pr)}function bn(e,t){return mt.call(e,t)||typeof e=="object"&&t in e&&Tt(e)===null}function wn(e){return At(Object(e))}function En(e){e=e==null?e:Object(e);var t=[];for(var n in e)t.push(n);return t}function Sn(t){return function(n){return n==null?e:n[t]}}function xn(e,t){if(t)return e.slice();var n=new e.constructor(e.length);return e.copy(n),n}function Tn(e){var t=new e.constructor(e.byteLength);return(new St(t)).set(new St(e)),t}function Nn(e){return st(ct(e),et,new e.constructor)}function Cn(e){var t=new e.constructor(e.source,j.exec(e));return t.lastIndex=e.lastIndex,t}function kn(e){return st(ht(e),tt,new e.constructor)}function Ln(e){return qt?Object(qt.call(e)):{}}function An(e,t){var n=t?Tn(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function On(e,t){var n=-1,r=e.length;t||(t=Array(r));while(++n<r)t[n]=e[n];return t}function Mn(e,t,n){return _n(e,t,n)}function _n(e,t,n,r){n||(n={});var i=-1,s=t.length;while(++i<s){var o=t[i],u=r?r(n[o],e[o],o,n,e):e[o];hn(n,o,u)}return n}function Dn(e,t){return Mn(e,Fn(e),t)}function Pn(t){return Kn(function(n,r){var i=-1,s=r.length,o=s>1?r[s-1]:e,u=s>2?r[2]:e;o=typeof o=="function"?(s--,o):e,u&&Wn(r[0],r[1],u)&&(o=s<3?e:o,s=1),n=Object(n);while(++i<s){var a=r[i];a&&t(n,a,i,o)}return n})}function Hn(e){return function(t,n,r){var i=-1,s=Object(t),o=r(t),u=o.length;while(u--){var a=o[e?u:++i];if(n(s[a],a,s)===!1)break}return t}}function jn(t,n){var r=t[n];return ur(r)?r:e}function In(e){return gt.call(e)}function qn(e){var t=e.length,n=e.constructor(t);return t&&typeof e[0]=="string"&&mt.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function Rn(e){return typeof e.constructor=="function"&&!Vn(e)?vn(Tt(e)):{}}function Un(e,t,n){var r=e.constructor;switch(t){case N:return Tn(e);case h:case p:return new r(+e);case C:case k:case L:case A:case O:case M:case _:case D:case P:return An(e,n);case g:return Nn(e);case y:case S:return new r(e);case w:return Cn(e);case E:return kn(e);case x:return Ln(e)}}function zn(t){var n=t?t.length:e;return ir(n)&&(Zn(t)||ar(t)||Yn(t))?ot(n,String):null}function Wn(e,t,n){if(!sr(n))return!1;var r=typeof t;return(r=="number"?er(n)&&ft(t,n.length):r=="string"&&t in n)?Gn(n[t],e):!1}function Xn(e){var t=typeof e;return t=="number"||t=="boolean"||t=="string"&&e!="__proto__"||e==null}function Vn(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||dt;return e===n}function $n(e){var t=e?e.length:0;return t?mn(e,1):[]}function Jn(e,t){if(typeof e!="function"||t&&typeof t!="function")throw new TypeError(i);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var o=e.apply(this,r);return n.cache=s.set(i,o),o};return n.cache=new Jn.Cache,n}function Kn(t,n){if(typeof t!="function")throw new TypeError(i);return n=Ot(n===e?t.length-1:fr(n),0),function(){var e=arguments,r=-1,i=Ot(e.length-n,0),s=Array(i);while(++r<i)s[r]=e[n+r];switch(n){case 0:return t.call(this,s);case 1:return t.call(this,e[0],s);case 2:return t.call(this,e[0],e[1],s)}var o=Array(n+1);r=-1;while(++r<n)o[r]=e[r];return o[n]=s,nt(t,this,o)}}function Qn(e){return dn(e,!0,!0)}function Gn(e,t){return e===t||e!==e&&t!==t}function Yn(e){return tr(e)&&mt.call(e,"callee")&&(!kt.call(e,"callee")||gt.call(e)==l)}function er(e){return e!=null&&ir(Bn(e))&&!rr(e)}function tr(e){return or(e)&&er(e)}function rr(e){var t=sr(e)?gt.call(e):"";return t==v||t==m}function ir(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=u}function sr(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function or(e){return!!e&&typeof e=="object"}function ur(e){return e==null?!1:rr(e)?yt.test(vt.call(e)):or(e)&&(at(e)?yt:q).test(e)}function ar(e){return typeof e=="string"||!Zn(e)&&or(e)&&gt.call(e)==S}function fr(e){if(!e)return e===0?e:0;e=lr(e);if(e===o||e===-o){var t=e<0?-1:1;return t*a}var n=e%1;return e===e?n?e-n:e:0}function lr(e){if(sr(e)){var t=rr(e.valueOf)?e.valueOf():e;e=sr(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(B,"");var n=I.test(e);return n||R.test(e)?X(e.slice(2),n?2:8):F.test(e)?f:+e}function pr(e){var t=Vn(e);if(!t&&!er(e))return wn(e);var n=zn(e),r=!!n,i=n||[],s=i.length;for(var o in e)bn(e,o)&&(!r||o!="length"&&!ft(o,s))&&(!t||o!="constructor")&&i.push(o);return i}function dr(e){var t=-1,n=Vn(e),r=En(e),i=r.length,s=zn(e),o=!!s,u=s||[],a=u.length;while(++t<i){var f=r[t];(!o||f!="length"&&!ft(f,a))&&(f!="constructor"||!n&&!!mt.call(e,f))&&u.push(f)}return u}function vr(e){return function(){return e}}var e,t="4.6.1",r=200,i="Expected a function",s="__lodash_hash_undefined__",o=1/0,u=9007199254740991,a=1.7976931348623157e308,f=0/0,l="[object Arguments]",c="[object Array]",h="[object Boolean]",p="[object Date]",d="[object Error]",v="[object Function]",m="[object GeneratorFunction]",g="[object Map]",y="[object Number]",b="[object Object]",w="[object RegExp]",E="[object Set]",S="[object String]",x="[object Symbol]",T="[object WeakMap]",N="[object ArrayBuffer]",C="[object Float32Array]",k="[object Float64Array]",L="[object Int8Array]",A="[object Int16Array]",O="[object Int32Array]",M="[object Uint8Array]",_="[object Uint8ClampedArray]",D="[object Uint16Array]",P="[object Uint32Array]",H=/[\\^$.*+?()[\]{}|]/g,B=/^\s+|\s+$/g,j=/\w*$/,F=/^[-+]0x[0-9a-f]+$/i,I=/^0b[01]+$/i,q=/^\[object .+?Constructor\]$/,R=/^0o[0-7]+$/i,U=/^(?:0|[1-9]\d*)$/,z={};z[l]=z[c]=z[N]=z[h]=z[p]=z[C]=z[k]=z[L]=z[A]=z[O]=z[g]=z[y]=z[b]=z[w]=z[E]=z[S]=z[x]=z[M]=z[_]=z[D]=z[P]=!0,z[d]=z[v]=z[T]=!1;var W={"function":!0,object:!0},X=parseInt,V=W[typeof exports]&&exports&&!exports.nodeType?exports:e,$=W[typeof module]&&module&&!module.nodeType?module:e,J=$&&$.exports===V?V:e,K=ut(V&&$&&typeof global=="object"&&global),Q=ut(W[typeof self]&&self),G=ut(W[typeof window]&&window),Y=ut(W[typeof this]&&this),Z=K||G!==(Y&&Y.window)&&G||Q||Y||Function("return this")(),pt=Array.prototype,dt=Object.prototype,vt=Function.prototype.toString,mt=dt.hasOwnProperty,gt=dt.toString,yt=RegExp("^"+vt.call(mt).replace(H,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),bt=J?Z.Buffer:e,wt=Z.Reflect,Et=Z.Symbol,St=Z.Uint8Array,xt=wt?wt.enumerate:e,Tt=Object.getPrototypeOf,Nt=Object.getOwnPropertySymbols,Ct=Object.create,kt=dt.propertyIsEnumerable,Lt=pt.splice,At=Object.keys,Ot=Math.max,Mt=jn(Z,"Map"),_t=jn(Z,"Set"),Dt=jn(Z,"WeakMap"),Pt=jn(Object,"create"),Ht={},Bt=Mt?vt.call(Mt):"",jt=_t?vt.call(_t):"",Ft=Dt?vt.call(Dt):"",It=Et?Et.prototype:e,qt=It?It.valueOf:e,gn=Hn();xt&&!kt.call({valueOf:1},"valueOf")&&(En=function(e){return lt(xt(e))});var Bn=Sn("length"),Fn=Nt||function(){return[]};if(Mt&&In(new Mt)!=g||_t&&In(new _t)!=E||Dt&&In(new Dt)!=T)In=function(e){var t=gt.call(e),n=t==b?e.constructor:null,r=typeof n=="function"?vt.call(n):"";if(r)switch(r){case Bt:return g;case jt:return E;case Ft:return T}return t};var Zn=Array.isArray,nr=bt?function(e){return e instanceof bt}:vr(!1),cr=Pn(function(e,t,n,r){_n(t,dr(t),e,r)}),hr=Kn(function(t){return t.push(e,cn),nt(cr,e,t)});Ut.prototype=Pt?Pt(null):dt,$t.prototype.clear=Jt,$t.prototype["delete"]=Kt,$t.prototype.get=Qt,$t.prototype.has=Gt,$t.prototype.set=Yt,Zt.prototype.clear=en,Zt.prototype["delete"]=tn,Zt.prototype.get=nn,Zt.prototype.has=rn,Zt.prototype.set=sn,Jn.Cache=$t,Rt.assignInWith=cr,Rt.constant=vr,Rt.defaults=hr,Rt.flatten=$n,Rt.keys=pr,Rt.keysIn=dr,Rt.memoize=Jn,Rt.rest=Kn,Rt.extendWith=cr,Rt.cloneDeep=Qn,Rt.eq=Gn,Rt.isArguments=Yn,Rt.isArray=Zn,Rt.isArrayLike=er,Rt.isArrayLikeObject=tr,Rt.isBuffer=nr,Rt.isFunction=rr,Rt.isLength=ir,Rt.isNative=ur,Rt.isObject=sr,Rt.isObjectLike=or,Rt.isString=ar,Rt.toInteger=fr,Rt.toNumber=lr,Rt.VERSION=t,(G||Q||{})._=Rt,typeof n=="function"&&typeof n.amd=="object"&&n.amd?n("lib/mscgenjs-core/lib/lodash/lodash.custom",[],function(){return Rt}):V&&$?(J&&(($.exports=Rt)._=Rt),V._=Rt):Z._=Rt}.call(this),n("lib/mscgenjs-core/render/graphics/svgutensils",["./constants","./idmanager","../../lib/lodash/lodash.custom"],function(e,t,n){"use strict";function s(t){var n=r.createElementNS(e.SVGNS,"svg");return n.setAttribute("version","1.1"),n.setAttribute("xmlns",e.SVGNS),n.setAttribute("xmlns:xlink",e.XLINKNS),n.setAttribute("id",t),n.setAttribute("width",0),n.setAttribute("height",0),r.body.appendChild(n),n}function o(e){var t=r.getElementById(i);t=t?t:s(i),t.appendChild(e);var n=e.getBBox();return t.removeChild(e),n}function u(e){var t=1e5;return Math.abs(e.height)>t||Math.abs(e.width)>t?{height:0,width:0,x:0,y:0}:e}function a(e){return typeof e.getBBox=="function"?u(o(e)):{height:15,width:15,x:2,y:2}}function f(t){var n=r.createElementNS(e.SVGNS,"tspan");return n.appendChild(r.createTextNode(t)),n}function l(t){var n=r.createElementNS(e.SVGNS,"text");return n.setAttribute("x","0"),n.setAttribute("y","0"),n.appendChild(f(t)),n}function c(){return a(l("ÁjyÎ9ƒ@💩")).height}function h(e){t.setPrefix(e);var n=r.getElementById(t.get());if(!!n){var i=r.getElementById(e);i?i.removeChild(n):r.body.removeChild(n)}}var r,i=t.get("bboxer");return{init:function(e){r=e},removeRenderedSVGFromElement:h,getBBox:a,calculateTextHeight:n.memoize(c),webkitNamespaceBugWorkaround:function(e){return e.replace(/\ xlink=/g," xmlns:xlink=","g").replace(/\ href=/g," xlink:href=","g")}}}),n("lib/mscgenjs-core/render/graphics/renderutensils",[],function(){"use strict";function e(e,t){t.scale=e/t.width,t.width*=t.scale,t.height*=t.scale,t.horizontaltransform*=t.scale,t.verticaltransform*=t.scale,t.x=0-t.horizontaltransform,t.y=0-t.verticaltransform}function t(e,t){return e?2*(e+1)*2*t:0}function n(e,t,n){return"-x"===e?t+(n-t)*.75:n}return{scaleCanvasToWidth:e,determineDepthCorrection:t,determineArcXTo:n}}),n("lib/mscgenjs-core/render/graphics/renderskeleton",["./svgelementfactory","./constants"],function(e,t){"use strict";function r(t,n){return n.forEach(function(n){n.type==="method"?t.appendChild(e.createMarkerPolygon(n.name,n.path,n.color)):t.appendChild(e.createMarkerPath(n.name,n.path,n.color))}),t}function i(){var e=n.createElement("style");return e.setAttribute("type","text/css"),e.appendChild(n.createTextNode(c())),e}function s(e){var r=n.createElementNS(t.SVGNS,"svg");return r.setAttribute("version","1.1"),r.setAttribute("id",e),r.setAttribute("xmlns",t.SVGNS),r.setAttribute("xmlns:xlink",t.XLINKNS),r}function o(s,o){var u=n.createElementNS(t.SVGNS,"defs");return u.appendChild(i()),u=r(u,o),u.appendChild(e.createGroup(s+"__defs")),u}function u(e){var r=n.createElementNS(t.SVGNS,"desc");return r.setAttribute("id",e+"__msc_source"),r}function a(t){var n=e.createGroup(t+"__body");return n.appendChild(e.createGroup(t+"__background")),n.appendChild(e.createGroup(t+"__arcspanlayer")),n.appendChild(e.createGroup(t+"__lifelinelayer")),n.appendChild(e.createGroup(t+"__sequencelayer")),n.appendChild(e.createGroup(t+"__notelayer")),n.appendChild(e.createGroup(t+"__watermark")),n}function f(t){return e.init(t.document),t.document}function l(e,t,r,i){n=f(i);var l=n.getElementById(e);l===null&&(l=n.body);var c=s(t);return c.appendChild(u(t)),c.appendChild(o(t,r)),c.appendChild(a(t)),l.appendChild(c),n}function c(){return"svg{  font-family:Helvetica,sans-serif;  font-size:"+t.FONT_SIZE+"px;  font-weight:normal;  font-style:normal;  text-decoration:none;  background-color:white;  stroke:black;  color:black;}rect{  fill:none;  stroke:black;  stroke-width:"+t.LINE_WIDTH+";}.bglayer{  fill:white;  stroke:white;  stroke-width:0;}rect.textbg{  fill:white;  stroke:white;  stroke-width:0;}line{  stroke:black;  stroke-width:"+t.LINE_WIDTH+";}.arcrowomit{  stroke-dasharray:2,2;}text{  color:inherit;  stroke:none;  text-anchor:middle;}text.entity{  text-decoration:underline;}text.anchor-start{  text-anchor:start;}path{  stroke:black;  color:black;  stroke-width:"+t.LINE_WIDTH+";  fill:none;}.dotted{  stroke-dasharray:5,2;}.striped{  stroke-dasharray:10,5;}.arrow-marker{  overflow:visible;}.arrow-style{  stroke-width:1;}.arcrowomit{  stroke-dasharray:2,2;}.box{  /* fill: #ffc;  no-inherit */  fill:white;}.comment{  stroke-dasharray:5,2;} .inherit{  stroke:inherit;  color:inherit;} .inherit-fill{  fill:inherit;}.watermark{  stroke:black;  color:black;  fill:black;  font-size: 48pt;  font-weight:bold;  opacity:0.14;}"}var n;return{bootstrap:l,init:f}}),n("lib/mscgenjs-core/render/text/asttransform",[],function(){"use strict";function e(e,t){e&&t&&e.forEach(function(e){t.forEach(function(t){t(e)})})}function t(e,t,n,r){r&&r.forEach(function(r){r(n,e,t)})}function n(e,n,i){n.forEach(function(s){t(e,n,s,i),s.arcs&&r(e,s.arcs,i)})}function r(e,t,r){e&&t&&r&&t.forEach(function(t){n(e,t,r)})}function i(t,n,i){return e(t.entities,n),r(t.entities,t.arcs,i),t}return{transform:i}}),n("lib/mscgenjs-core/render/text/arcmappings",[],function(){"use strict";var e={"->":"rvee","<->":"rvee","=>":"normal","<=>":"normal","-x":"oinvonormal"},t={box:"box",abox:"hexagon",rbox:"box",note:"note"},n={">>":"dashed","<<>>":"dashed","..":"dashed",":>":"bold","<:>":"bold","::":"bold",rbox:"rounded"},r={"|||":"emptyarc","...":"emptyarc","---":"emptyarc","->":"directional","=>":"directional","=>>":"directional",">>":"directional",":>":"directional","-x":"directional","<-":"directional","<=":"directional","<<=":"directional","<<":"directional","<:":"directional","x-":"directional",note:"box",box:"box",abox:"box",rbox:"box","<->":"bidirectional","<=>":"bidirectional","<<=>>":"bidirectional","<<>>":"bidirectional","<:>":"bidirectional","--":"nondirectional","==":"nondirectional","..":"nondirectional","::":"nondirectional",alt:"inline_expression","else":"inline_expression",opt:"inline_expression","break":"inline_expression",par:"inline_expression",seq:"inline_expression",strict:"inline_expression",neg:"inline_expression",critical:"inline_expression",ignore:"inline_expression",consider:"inline_expression",assert:"inline_expression",loop:"inline_expression",ref:"inline_expression",exc:"inline_expression"},i={"<-":"->","<=":"=>","<<=":"=>>","<<":">>","<:":":>","x-":"-x"};return{getArrow:function(t){return e[t]},getShape:function(e){return t[e]},getStyle:function(e){return n[e]},getAggregate:function(e){return r[e]},getNormalizedKind:function(e){return i[e]||e}}}),n("lib/mscgenjs-core/render/text/textutensils",[],function(){"use strict";return{wrap:function(e,t){var n=0,r=[],i=0,s=0,o=0,u=0,a=e.replace(/[\t\n]+/g," ").replace(/\\n/g,"\n");while(u<=a.length)u>=a.length?r.push(a.substring(i,u)):a[u]==="\n"?(n=0,o=u,r.push(a.substring(i,o)),i=o+1):n++>=t&&(o=a.substring(0,u).lastIndexOf(" "),o===-1||o<i?(n=1,o=u,s=u):(n=0,s=o+1),r.push(a.substring(i,o)),i=s),u++;return r},unescapeString:function(e){return e.replace(/\\\"/g,'"')},escapeString:function(e){return e.replace(/\\\"/g,'"').replace(/\"/g,'\\"')}}}),n("lib/mscgenjs-core/render/text/flatten",["./asttransform","./arcmappings","../../lib/lodash/lodash.custom","./textutensils"],function(e,t,n,r){"use strict";function s(e){e.label===undefined&&(e.label=e.name)}function o(e){!e.label||(e.label=r.unescapeString(e.label)),!e.id||(e.id=r.unescapeString(e.id))}function u(e){e.label=e.label?e.label:""}function a(e){if(e.kind&&t.getNormalizedKind(e.kind)!==e.kind){e.kind=t.getNormalizedKind(e.kind);var n=e.from;e.from=e.to,e.to=n}return e}function f(e,t){!e.linecolor&&t.arclinecolor&&(e.linecolor=t.arclinecolor),!e.textcolor&&t.arctextcolor&&(e.textcolor=t.arctextcolor),!e.textbgcolor&&t.arctextbgcolor&&(e.textbgcolor=t.arctextbgcolor)}function l(e,t){if(e&&e.from){var n=t.filter(function(t){return t.name===e.from});n.length>0&&f(e,n[0])}}function c(e){return e.arcs.reduce(function(e,t){return e+(t[0].arcs?c(t[0])+1:0)},e.arcs.length)}function h(e,r,s,o,u){var a={};"inline_expression"===t.getAggregate(e[0].kind)?(a=n.cloneDeep(e[0]),a.arcs?(a.numberofrows=c(a),delete a.arcs,r.arcs.push([a]),e[0].arcs.forEach(function(e){h(e,r,s+1,a.from,a.to),e.forEach(function(e){f(e,a)})}),s>i&&(i=s)):r.arcs.push([a]),r.arcs.push([{kind:"|||",from:a.from,to:a.to}]),a.depth=s):(o&&u&&e.filter(function(e){return"emptyarc"===t.getAggregate(e.kind)}).forEach(function(e){e.from=o,e.to=u,e.depth=s}),r.arcs.push(e))}function p(e){var t={};return i=0,!e.options||(t.options=n.cloneDeep(e.options)),!e.entities||(t.entities=n.cloneDeep(e.entities)),t.arcs=[],e&&e.arcs&&e.arcs.forEach(function(e){h(e,t,0)}),t.depth=i+1,t}function d(e,t){return e.filter(function(e){return t.from!==e.name}).map(function(e){return t.to=e.name,n.cloneDeep(t)})}function v(e){if(e.entities&&e.arcs){var t=[],r={};e.arcs.forEach(function(i,s){i.filter(function(e){return e.to==="*"}).forEach(function(o,u){r=n.cloneDeep(o),delete e.arcs[s][u],t=d(e.entities,r),i[u]=t.shift(),e.arcs[s]=i.concat(t)})})}return e}var i=0;return{swapRTLArc:a,unwind:p,explodeBroadcasts:v,flatten:function(t){return e.transform(p(t),[s,o],[a,l,o,u])},dotFlatten:function(t){return v(e.transform(t,[s],[a,l]))}}}),n("lib/mscgenjs-core/render/graphics/swap",[],function(){"use strict";function e(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}return{swapfromto:function(t){e(t,"from","to")}}}),n("lib/mscgenjs-core/render/graphics/rowmemory",[],function(){"use strict";function r(r,i){e=[],t=r,n=i}function i(r){return e[r]?e[r]:{y:t+1.5*n+r*n,height:n}}function s(){return i(e.length-1)}function o(t,r,s){if(r===undefined||r<n)r=n;if(s===undefined){var o=i(t-1);o&&o.y>0&&(s=o.y+(o.height+r)/2)}e[t]={y:s,height:r}}var e=[],t=0,n=0;return{clear:r,get:i,getLast:s,set:o}}),n("lib/mscgenjs-core/render/graphics/markermanager",["../../lib/lodash/lodash.custom","../text/arcmappings"],function(e,t){"use strict";function i(e,t,n){if(t&&n&&["<->","->"].indexOf(e>-1))return t<n?"signal":"signal-u"}function s(e,t,n){return"<->"===e&&t<=n?"signal-l":"signal-lu"}function o(e,t,r,o,u){var a=[];return n[t]&&n[t].attributes&&(a=n[t].attributes.map(function(n){return{name:n.name,value:n.value.replace(/\{\{signal-marker-end\}\}/g,i(t,o,u)).replace(/\{\{signal-marker-start\}\}/g,s(t,o,u)).replace(/\{\{id\}\}/g,e).replace(/\{\{color\}\}/g,r||"black")}})),a}function u(e,r){return n[t.getNormalizedKind(e)].marker.name+(r?" "+r:" black")}function a(e,r){function i(t){a(e,t)}return Array.isArray(r)&&r.forEach(i),!r.arcs||r.arcs.forEach(i),!!r.kind&&!!n[t.getNormalizedKind(r.kind)]&&!!n[t.getNormalizedKind(r.kind)].marker&&e.indexOf(u(r.kind,r.linecolor))<0&&e.push(u(r.kind,r.linecolor)),e}function f(e){return{kind:e.split(" ")[0],color:e.split(" ")[1]}}function l(e){return e.arcs.reduce(a,[]).sort().map(f)}var n={"->":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}{{signal-marker-end}}-{{color}})"}],marker:{name:"signal"}},"<->":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}{{signal-marker-end}}-{{color}})"},{name:"marker-start",value:"url(#{{id}}{{signal-marker-start}}-{{color}})"}],marker:{name:"signal"}},"=>>":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}callback-{{color}})"}],marker:{name:"callback",end:""}},"<<=>>":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}callback-{{color}})"},{name:"marker-start",value:"url(#{{id}}callback-l-{{color}})"}],marker:{name:"callback",end:"",start:"-l"}},">>":{attributes:[{name:"style",value:"stroke:{{color}};stroke-dasharray:5,2;"},{name:"marker-end",value:"url(#{{id}}callback-{{color}})"}],marker:{name:"callback",end:""}},"<<>>":{attributes:[{name:"style",value:"stroke:{{color}};stroke-dasharray:5,2;"},{name:"marker-end",value:"url(#{{id}}callback-{{color}})"},{name:"marker-start",value:"url(#{{id}}callback-l-{{color}})"}],marker:{name:"callback",end:"",start:"-l"}},"..":{attributes:[{name:"style",value:"stroke:{{color}};stroke-dasharray:5,2;"}]},"--":{attributes:[{name:"style",value:"stroke:{{color}};"}]},"==":{attributes:[{name:"style",value:"stroke:{{color}};"}]},"::":{attributes:[{name:"style",value:"stroke:{{color}};"}]},"=>":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}method-{{color}})"}],marker:{name:"method",end:""}},"<=>":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}method-{{color}})"},{name:"marker-start",value:"url(#{{id}}method-l-{{color}})"}],marker:{name:"method",end:"",start:"-l"}},":>":{attributes:[{name:"style",value:"stroke:{{color}};"},{name:"marker-end",value:"url(#{{id}}method-{{color}})"}],marker:{name:"method",end:""}},"<:>":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}method-{{color}})"},{name:"marker-start",value:"url(#{{id}}method-l-{{color}})"}],marker:{name:"method",end:"",start:"-l"}},"-x":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}lost-{{color}})"}],marker:{name:"lost",end:""}}},r={signal:{variants:[{name:"",path:"M9,3 l-8, 2"},{name:"-u",path:"M9,3 l-8,-2"},{name:"-l",path:"M9,3 l 8, 2"},{name:"-lu",path:"M9,3 l 8,-2"}]},method:{variants:[{name:"",path:"1,1  9,3  1,5"},{name:"-l",path:"17,1 9,3 17,5"}]},callback:{variants:[{name:"",path:"M 1,1 l 8,2 l-8,2"},{name:"-l",path:"M17,1 l-8,2 l 8,2"}]},lost:{variants:[{name:"",path:"M7,0 l5,6 M7,6 l5,-6"}]}};return{getAttributes:o,getMarkerDefs:function(t,n){return e.flatten(l(n).map(function(e){return r[e.kind].variants.map(function(n){return{name:t+e.kind+n.name+"-"+e.color,path:n.path,color:e.color,type:e.kind}})}))}}}),n("lib/mscgenjs-core/render/graphics/renderlabels",["./svgelementfactory","./svgutensils","./constants","../text/textutensils","../text/arcmappings"],function(e,t,n,r,i){"use strict";function s(e,t){t&&e.setAttribute("style","fill:"+t+";")}function o(e,t,n){s(e,t&&!n?"blue":n)}function u(n,r){var i=e.createRect(t.getBBox(n),"textbg");return r&&i.setAttribute("style","fill: "+r+"; stroke:"+r+";"),i}function a(t,n,r,i,s,o){var u={};return t===0?u=e.createText(n,r,i,s,o.url,o.id,o.idurl):u=e.createText(n,r,i,s,o.url),u}function f(e,r,i,u,f,l){var c=i+(f+.25)*t.calculateTextHeight(),h;!l||(l.underline&&(h="entity"),l.alignLeft&&(h="anchor-start"),l.alignAround&&(c=i+(f+.25)*(t.calculateTextHeight()+n.LINE_WIDTH)));var p=a(f,e,r,c,h,u);return s(p,u.textcolor),o(p,u.url,u.textcolor),p}function l(r,i,s,o){var a=e.createGroup(o);if(r.label){var l=i.x+i.width/2,c=h(r.label,r.kind,i.width,n.FONT_SIZE,s?s.wordWrapArcs:!1),p={};!!s&&s.alignAbove&&c.forEach(function(){c.push("")});var d=i.y-(c.length-1)/2*(t.calculateTextHeight()+1);!!s&&s.alignAround&&(c.length===1&&c.push(""),d=i.y-(c.length-1)/2*(t.calculateTextHeight()+n.LINE_WIDTH+1)),c.forEach(function(e,t){e!==""&&(p=f(e,l,d,r,t,s),!!s&&s.ownBackground&&a.appendChild(u(p,r.textbgcolor)),a.appendChild(p)),d++})}return a}function c(e,t){var n=Math.abs(e),r=12;return n<=160?n/(t/r*8):n<=320?n/(t/r*6.4):n<=480?n/(t/r*5.9):n/(t/r*5.6)}function h(e,t,n,s,o){return"box"===i.getAggregate(t)||undefined===t||o?r.wrap(e,c(n,s)):e.split("\\n")}return{createLabel:l,splitLabel:h}}),n("lib/mscgenjs-core/render/graphics/entities",["./renderlabels","./constants"],function(e,t){"use strict";function u(e){s.interEntitySpacing=n,s.height=i,s.width=r,e&&e.hscale&&(s.interEntitySpacing=e.hscale*n,s.width=e.hscale*r),o={}}function a(e,t){return{from:f(e),to:f(t)}}function f(e){return o[e]}function l(e,t){o[e.name]=t+s.width/2}function c(){return s}function h(e){s.height=e}var n=160,r=100,i=34,s={interEntitySpacing:n,height:i,width:r},o={};return{init:u,getX:f,setX:l,getOAndD:a,setHeight:h,getDims:c,getNoEntityLines:function(n){return e.splitLabel(n,"box",s.width,t.FONT_SIZE).length}}}),n("lib/mscgenjs-core/render/graphics/renderast",["./svgelementfactory","./svgutensils","./renderutensils","./renderskeleton","../text/flatten","../text/arcmappings","./swap","./rowmemory","./idmanager","./markermanager","./entities","./renderlabels","./constants"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";function y(e,n,r,s){var o=i.flatten(e);b(o,n,r,s),w(o),E(o);var u=s.document.getElementById(r);return u?t.webkitNamespaceBugWorkaround(u.innerHTML):t.webkitNamespaceBugWorkaround(s.document.body.innerHTML)}function b(e,n,i,s){a.setPrefix(i),m.document=r.bootstrap(i,a.get(),f.getMarkerDefs(a.get(),e),s),t.init(m.document),S(m,e.depth),N(m,e.options),C(m,n)}function w(e){H(e.entities),u.clear(l.getDims().height,m.arcRowHeight),j(e.arcs,e.entities)}function E(e){var t=k(e);L(m,t),O(e.options,t),M(t)}function S(e,t){x(e.layer,e.document),e.maxDepth=t?t:0}function x(e,t){e.defs=t.getElementById(a.get("__defs")),e.lifeline=t.getElementById(a.get("__lifelinelayer")),e.sequence=t.getElementById(a.get("__sequencelayer")),e.notes=t.getElementById(a.get("__notelayer")),e.inline=t.getElementById(a.get("__arcspanlayer")),e.watermark=t.getElementById(a.get("__watermark"))}function T(e,t){e.arcRowHeight=d,e.arcGradient=v,e.wordWrapArcs=!1,t&&(t.arcgradient&&(e.arcRowHeight=parseInt(t.arcgradient,10)+d,e.arcGradient=parseInt(t.arcgradient,10)+v),t.wordwraparcs&&(e.wordWrapArcs=t.wordwraparcs))}function N(e,t){l.init(t),T(e,t)}function C(t,n){if(n){var r=e.createTextNode("\n\n# Generated by mscgen_js - https://sverweij.github.io/mscgen_js\n"+n);t.document.getElementById(a.get("__msc_source")).appendChild(r)}}function k(e){var t=n.determineDepthCorrection(e.depth,h.LINE_WIDTH),r=u.getLast(),i={width:e.entities.length*l.getDims().interEntitySpacing+t,height:r.y+r.height/2+2*p,horizontaltransform:(l.getDims().interEntitySpacing+t-l.getDims().width)/2,autoscale:!!e.options&&!!e.options.width&&e.options.width==="auto",verticaltransform:p,scale:1};return i.x=0-i.horizontaltransform,i.y=0-i.verticaltransform,i}function L(t,n){var r=e.createRect(n,"bglayer");t.document.getElementById(a.get("__background")).appendChild(r)}function A(t,n){m.layer.watermark.appendChild(e.createDiagonalText(t,n))}function O(e,t){e&&(e.watermark&&A(e.watermark,t),e.width&&e.width!=="auto"&&n.scaleCanvasToWidth(e.width,t))}function M(e){var t=m.document.getElementById(a.get()),n=m.document.getElementById(a.get("__body"));n.setAttribute("transform","translate("+e.horizontaltransform+","+e.verticaltransform+")"+" scale("+e.scale+","+e.scale+")"),!e.autoscale||e.autoscale!==!0?(t.setAttribute("width",e.width.toString()),t.setAttribute("height",e.height.toString())):(t.setAttribute("width","100%"),t.setAttribute("height","100%"),t.setAttribute("viewBox","0 0 "+e.width.toString()+" "+e.height.toString()))}function _(e){var n=e[0],r=2;return e.forEach(function(e){var t=l.getNoEntityLines(e.label);t>r&&(r=t,n=e)}),r>2?Math.max(l.getDims().height,t.getBBox(D(n)).height):l.getDims().height}function D(t){var n=e.createGroup(a.get(t.name)),r=l.getDims(),i=c.createLabel(t,{x:0,y:r.height/2,width:r.width},{underline:!0}),s=e.createRect(r,null,t.linecolor,t.textbgcolor);return n.appendChild(s),n.appendChild(i),n}function P(t,n){m.layer.defs.appendChild(D(t)),m.layer.sequence.appendChild(e.createUse(n,0,a.get(t.name)))}function H(e){var t=0;e&&(l.setHeight(_(e)+h.LINE_WIDTH*2),e.forEach(function(e){P(e,t),l.setX(e,t),t+=l.getDims().interEntitySpacing})),m.arcEndX=t-l.getDims().interEntitySpacing+l.getDims().width}function B(n,r,i){var o=!1,f=[];u.set(r),n.forEach(function(e,n){var p=a.get(r.toString()+"_"+n.toString()),d;switch(s.getAggregate(e.kind)){case"emptyarc":d=z(e,p),o="..."===e.kind,f.push({id:p,layer:m.layer.sequence});break;case"box":d=J(p,l.getOAndD(e.from,e.to),e),f.push({id:p,layer:m.layer.notes});break;case"inline_expression":d=F(p+"_label",e),f.push({id:p+"_label",layer:m.layer.notes}),g.push({id:p,arc:e,rownum:r});break;default:if(e.from&&e.to){var v=0,y=0;if(e.to==="*"){var b=e.label;y=l.getX(e.from),i.forEach(function(t,n){t.name!==e.from&&(v=l.getX(t.name),e.label="",m.layer.defs.appendChild(X(p+"bc"+n,e,y,v)),f.push({id:p+"bc"+n,layer:m.layer.sequence}))}),e.label=b,d=c.createLabel(e,{x:0,y:0,width:m.arcEndX},{alignAround:!0,ownBackground:!0,wordWrapArcs:m.wordWrapArcs},p+"_lbl"),f.push({id:p+"_lbl",layer:m.layer.sequence})}else d=X(p,e,l.getX(e.from),l.getX(e.to)),f.push({id:p,layer:m.layer.sequence})}}d&&(u.set(r,Math.max(u.get(r).height,t.getBBox(d).height+2*h.LINE_WIDTH)),m.layer.defs.appendChild(d))});var p="arcrow_"+r.toString(),d="arcrow";o&&(d="arcrowomit"),m.layer.defs.appendChild(R(i,d,u.get(r).height,a.get(p))),m.layer.lifeline.appendChild(e.createUse(0,u.get(r).y,a.get(p))),f.forEach(function(t){t.layer.appendChild(e.createUse(0,u.get(r).y,t.id))})}function j(t,n){g=[],m.layer.defs.appendChild(R(n,a.get("arcrow"))),m.layer.lifeline.appendChild(e.createUse(0,u.get(-1).y,a.get("arcrow")));if(t){for(var r=0;r<t.length;r++)B(t[r],r,n);I(g)}}function F(n,r){var i={from:l.getX(r.from),to:l.getX(r.to)},s=7;i.from>i.to&&o.swapfromto(i);var u=i.to-i.from+(l.getDims().interEntitySpacing-2*h.LINE_WIDTH)-s-h.LINE_WIDTH,a=i.from-(l.getDims().interEntitySpacing-3*h.LINE_WIDTH)/2-(m.maxDepth-r.depth)*2*h.LINE_WIDTH,f=e.createGroup(n);r.label=r.kind+(r.label?": "+r.label:"");var p=c.createLabel(r,{x:a+h.LINE_WIDTH-u/2,y:m.arcRowHeight/4,width:u},{alignLeft:!0,ownBackground:!1,wordWrapArcs:m.wordWrapArcs}),d=t.getBBox(p),v=Math.max(d.height+2*h.LINE_WIDTH,m.arcRowHeight/2-2*h.LINE_WIDTH),g=Math.min(d.width+2*h.LINE_WIDTH,u),y=e.createEdgeRemark({width:g-h.LINE_WIDTH+s,height:v,x:a,y:0},"box",r.linecolor,r.textbgcolor,s);return f.appendChild(y),f.appendChild(p),f}function I(t){t.forEach(function(t){m.layer.defs.appendChild(q(t)),m.layer.inline.appendChild(e.createUse(0,u.get(t.rownum).y,t.id))})}function q(e){var t=u.get(e.rownum).y,n=u.get(e.rownum+e.arc.numberofrows+1).y,r=n-t;return e.arc.label="",J(e.id,l.getOAndD(e.arc.from,e.arc.to),e.arc,r)}function R(t,n,r,i){i||(i=n);if(!r||r<m.arcRowHeight)r=m.arcRowHeight;var s=e.createGroup(i);return t.forEach(function(t){var i=e.createLine({xFrom:l.getX(t.name),yFrom:0-r/2,xTo:l.getX(t.name),yTo:r/2},n);t.linecolor&&i.setAttribute("style","stroke : "+t.linecolor+";"),s.appendChild(i)}),s}function U(t,n,r,i,s){var o=2*(m.arcRowHeight/5),u=l.getDims().interEntitySpacing/2,c={};if(i){c=e.createGroup();var p=e.createUTurn({x:n,y:o/2},r+o-2*h.LINE_WIDTH,u-2*h.LINE_WIDTH,t!=="::"),d=e.createUTurn({x:n,y:o/2},r+o-h.LINE_WIDTH,u),v=e.createUTurn({x:n,y:o/2},r+o,u,t!=="::");p.setAttribute("style","stroke:"+s),f.getAttributes(a.get(),t,s,n,n).forEach(function(e){d.setAttribute(e.name,e.value)}),d.setAttribute("style","stroke:transparent;"),v.setAttribute("style","stroke:"+s),c.appendChild(p),c.appendChild(v),c.appendChild(d)}else c=e.createUTurn({x:n,y:o/2},r+o,u,t==="-x"),f.getAttributes(a.get(),t,s,n,n).forEach(function(e){c.setAttribute(e.name,e.value)});return c}function z(e,t){var n;e.from&&e.to&&l.getX(e.from)>l.getX(e.to)&&o.swapfromto(e);switch(e.kind){case"...":case"|||":n=V(t,e);break;case"---":n=$(t,e)}return n}function W(e){return e.arcskip?e.arcskip*m.arcRowHeight:0}function X(t,r,i,s){var o=e.createGroup(t),u=r.kind==="<:>"?"bidi":r.kind==="::"?"nodi":"",p=[":>","::","<:>"].indexOf(r.kind)>-1,d=W(r),v=d===0?m.arcGradient:d;s=n.determineArcXTo(r.kind,i,s);if(i===s){o.appendChild(U(r.kind,i,d,p,r.linecolor));var g=2*l.getDims().interEntitySpacing/3;o.appendChild(c.createLabel(r,{x:i+1.5*h.LINE_WIDTH-g/2,y:0-m.arcRowHeight/5-h.LINE_WIDTH/2,width:g},{alignLeft:!0,alignAbove:!0,ownBackground:!0,wordWrapArcs:m.wordWrapArcs}))}else{var y=e.createLine({xFrom:i,yFrom:0,xTo:s,yTo:v},u,p);f.getAttributes(a.get(),r.kind,r.linecolor,i,s).forEach(function(e){y.setAttribute(e.name,e.value)}),o.appendChild(y),o.appendChild(c.createLabel(r,{x:i,y:0,width:s-i},{alignAround:!0,ownBackground:!0,wordWrapArcs:m.wordWrapArcs}))}return o}function V(t,n){var r=0,i=m.arcEndX,s=e.createGroup(t);return n.from&&n.to&&(r=l.getX(n.from),i=Math.abs(l.getX(n.to)-l.getX(n.from))),s.appendChild(c.createLabel(n,{x:r,y:0,width:i},{ownBackground:!0,wordWrapArcs:m.wordWrapArcs},t+"_lbl")),s}function $(t,n){var r=0,i=m.arcEndX,s="dotted",o=e.createGroup(t);if(n.from&&n.to){var u=(m.maxDepth-n.depth)*2*h.LINE_WIDTH;r=l.getX(n.from)-(l.getDims().interEntitySpacing+2*h.LINE_WIDTH)/2-u,i=l.getX(n.to)+(l.getDims().interEntitySpacing+2*h.LINE_WIDTH)/2+u,s="striped"}var a=e.createLine({xFrom:r,yFrom:0,xTo:i,yTo:0},s);return o.appendChild(a),o.appendChild(V(t+"_txt",n)),n.linecolor&&a.setAttribute("style","stroke: "+n.linecolor+";"),o}function J(n,r,i,s){r.from>r.to&&o.swapfromto(r);var u=r.to-r.from+l.getDims().interEntitySpacing-2*h.LINE_WIDTH,a=6,f=r.from-(l.getDims().interEntitySpacing-2*h.LINE_WIDTH)/2,p=e.createGroup(n),d,v=c.createLabel(i,{x:f,y:0,width:u}),g=t.getBBox(v),y=s?s:Math.max(g.height+2*h.LINE_WIDTH,m.arcRowHeight-2*h.LINE_WIDTH),b={width:u,height:y,x:f,y:0-y/2};switch(i.kind){case"box":d=e.createRect(b,"box",i.linecolor,i.textbgcolor);break;case"rbox":d=e.createRect(b,"box",i.linecolor,i.textbgcolor,a,a);break;case"abox":b.y=0,d=e.createABox(b,"box",i.linecolor,i.textbgcolor);break;case"note":d=e.createNote(b,"box",i.linecolor,i.textbgcolor);break;default:var w=(m.maxDepth-i.depth)*2*h.LINE_WIDTH;d=e.createRect({width:u+w*2,height:y,x:f-w,y:0},"box",i.linecolor,i.textbgcolor)}return p.appendChild(d),p.appendChild(v),p}function K(e,n){m.document=r.init(n),t.init(m.document),t.removeRenderedSVGFromElement(e)}var p=3,d=38,v=0,m={arcRowHeight:d,arcGradient:v,arcEndX:0,wordWrapArcs:!1,maxDepth:0,document:{},layer:{defs:{},lifeline:{},sequence:{},notes:{},inline:{}}},g=[];return{clean:K,renderAST:y}}),n("utl/exporter",[],function(){"use strict";function t(e,t,n){return e.pathname+"?lang="+n+"&msc="+encodeURIComponent(t)}function n(n,r,i){return t(n,r,i).length<e}var e=4094;return{toLocationString:function(e,r,i){var s="# source too long for an URL";return n(e,r,i)&&(s=r),t(e,s,i)}}}),n("embedding/config",[],function(){"use strict";function t(e,t){Object.getOwnPropertyNames(t).forEach(function(n){e[n]=t[n]})}var e={defaultLanguage:"mscgen",parentElementPrefix:"mscgen_js-parent_",clickable:!1,clickURL:"https://sverweij.github.io/mscgen_js/",loadFromSrcAttribute:!1};return{getConfig:function(){return"undefined"!=typeof mscgen_js_config&&mscgen_js_config&&"object"==typeof mscgen_js_config&&t(e,mscgen_js_config),e}}}),n("utl/tpl",[],function(){"use strict";return{applyTemplate:function(t,n){var r=t;return!n||Object.keys(n).forEach(function(e){r=r.replace(new RegExp("{"+e+"}","g"),n[e])}),r}}}),n("embedding/error-rendering",["../utl/tpl"],function(e){"use strict";function s(e,t){var n=e.toString(),r=t-n.length;for(var i=0;i<r;i++)n=" "+n;return n}function o(e,t){return s(t,3)+" "+e}function u(t,n){return t.split("").reduce(function(t,r,s){return s===n?t+e.applyTemplate(i,{"char":a(r)}):t+a(r)},"")}function a(e){return e.replace(/</g,"&lt;")}var t="<pre><div style='color: red'># ERROR on line {line}, column {col} - {message}</div>",n="<pre><div style='color: red'># ERROR {message}</div>",r="<mark>{line}\n</mark>",i="<span style='text-decoration:underline'>{char}</span>";return{formatNumber:s,deHTMLize:a,renderError:function(s,f,l){var c=f?e.applyTemplate(t,{message:l,line:f.start.line,col:f.start.column}):e.applyTemplate(n,{message:l});return s.split("\n").reduce(function(t,n,i){return!f||i!==f.start.line-1?t+a(o(n,i+1))+"\n":t+e.applyTemplate(r,{line:o(u(n,f.start.column-1),i+1)})},c)+"</pre>"}}}),n("utl/domutl",[],function(){"use strict";return{ajax:function(e,t,n){var r=new XMLHttpRequest;r.onreadystatechange=function(i){i.target.readyState===XMLHttpRequest.DONE&&(200===r.status?t(i):n(i))},r.open("GET",e),r.responseType="text";try{r.send()}catch(i){n(i)}}}}),t(["lib/mscgenjs-core/parse/xuparser","lib/mscgenjs-core/parse/msgennyparser","lib/mscgenjs-core/render/graphics/renderast","utl/exporter","embedding/config","embedding/error-rendering","utl/domutl","utl/tpl"],function(e,t,n,r,i,s,o,u){"use strict";function p(){d();var e=document.getElementsByClassName("mscgen_js");v(e,0),v(document.getElementsByTagName("mscgen"),e.length)}function d(){var e=document.scripts;for(var t=0;t<e.length;t++)!!h[e[t].type]&&!e[t].hasAttribute("data-renderedby")&&(e[t].insertAdjacentHTML("afterend",u.applyTemplate(a,{src:e[t].src?u.applyTemplate(f,{src:e[t].src}):"",lang:h[e[t].type]||i.getConfig().defaultLanguage,msc:e[t].textContent.replace(/</g,"&lt;")})),e[t].setAttribute("data-renderedby","mscgen_js"))}function v(e,t){for(var n=0;n<e.length;n++)m(e[n],t+n)}function m(e,t){e.hasAttribute("data-renderedby")||y(e,t)}function g(e,t){e.innerHTML=u.applyTemplate("<div style='color: red'>{string}</div>",{string:t})}function y(e,t){E(e,t),e.setAttribute("data-renderedby","mscgen_js"),i.getConfig().loadFromSrcAttribute&&!!e.getAttribute("data-src")?o.ajax(e.getAttribute("data-src"),function(n){b(e,n.target.response)},function(){g(e,u.applyTemplate(l,{url:e.getAttribute("data-src")}))}):!i.getConfig().loadFromSrcAttribute&&!!e.getAttribute("data-src")?g(e,u.applyTemplate(c,{url:e.getAttribute("data-src")})):b(e,e.textContent)}function b(e,t){var n=S(e),r=x(t,n);r.entities?T(r,e.id,t,n):e.innerHTML=s.renderError(t,r.location,r.message)}function w(e,t,n){var s={pathname:"index.html"},o=document.createElement("a");return o.setAttribute("href",i.getConfig().clickURL+r.toLocationString(s,e,t)),o.setAttribute("id",n+"link"),o.setAttribute("style","text-decoration: none;"),o.setAttribute("title","click to edit in the mscgen_js interpreter"),o}function E(e,t){e.id||(e.id=i.getConfig().parentElementPrefix+t.toString())}function S(e){var t=e.getAttribute("data-language");return t||(t=i.getConfig().defaultLanguage),t}function x(n,r){var i={};try{"msgenny"===r?i=t.parse(n):"json"===r?i=JSON.parse(n):i=e.parse(n)}catch(s){return s}return i}function T(e,t,r,s){var o=document.getElementById(t);o.innerHTML="",!0===i.getConfig().clickable&&(o.appendChild(w(r,s,t)),t+="link"),n.clean(t,window),n.renderAST(e,r,t,window)}var a="<span class='mscgen_js' {src} data-language='{lang}'>{msc}<span>",f="data-src='{src}' ",l="ERROR: Could not find or open the URL '{url}' specified in the <code>data-src</code> attribute.",c="ERROR: Won't load the chart specified in <code>data-src='{url}'</code>, because loading from separate files is switched off in the mscgen_js configuration. <br><br>See <a href='https://sverweij.github.io/mscgen_js/embed.html#loading-from-separate-files'>Loading charts from separate files</a> in the mscgen_js embedding guide how to enable it.",h={"text/x-mscgen":"mscgen","text/x-msgenny":"msgenny","text/x-xu":"xu"};p()}),n("mscgen-inpage",function(){})})();